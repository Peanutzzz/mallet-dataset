order transaction listener impl rocket m q transaction listener tx producer group order tx produce group core pool size maximum pool size public class order transaction listener impl implement rocket m q local transaction listener autowire private i order service order service override public rocket m q local transaction state execute local transaction message message object arg string order json new string byte message get payload order order json parse object order json order class order service save order string produce error string message get header get produce error if equal produce error system err println exception commit throw new runtime exception return rocket m q local transaction state commit override public rocket m q local transaction state check local transaction message message string order id string message get header get order id system out println order id order id int count select count from t order where order id order id system out println return count rocket m q local transaction state commit rocket m q local transaction state rollback 
