base integration test before class public static void before class throw exception system set property config const apollo meta key meta service url 
bootstrap config test before class public static void before class throw exception do set up system set property property source constant apollo bootstrap enable true mock config mock config class when mock config get property name then return set new hash set test bean conditional on key some property when mock config get property eq test bean conditional on key any string then return boolean true to string when mock config get property eq some property any string then return some value mock config config const namespace application mock config 
bootstrap config test before class public static void before class throw exception do set up system set property property source constant apollo bootstrap enable true system set property property source constant apollo bootstrap namespace string format s s config const namespace application fx apollo namespace config config mock config class config another config mock config class when config get property name then return set new hash set test bean conditional on key when config get property eq test bean conditional on key any string then return boolean true to string mock config config const namespace application another config mock config fx apollo namespace config 
bootstrap config test before class public static void before class throw exception do set up system set property property source constant apollo bootstrap enable true system set property property source constant apollo bootstrap namespace string format s s application yml fx apollo namespace prepare yaml config file application yml read yaml content as config file property case6 yml config another config mock config class mock config config const namespace application another config mock config fx apollo namespace another config 
bootstrap config test before class public static void before class throw exception do set up system set property property source constant apollo bootstrap enable true config config mock config class when config get property name then return set new hash set test bean conditional on key when config get property eq test bean conditional on key any string then return boolean false to string mock config config const namespace application config 
bootstrap config test before class public static void before class throw exception do set up system set property property source constant apollo bootstrap enable true system set property property source constant apollo bootstrap namespace application yml prepare yaml config file application yml read yaml content as config file property case7 yml 
bootstrap config test before class public static void before class throw exception do set up system set property property source constant apollo bootstrap enable true config config mock config class mock config config const namespace application config 
bootstrap config test before class public static void before class throw exception do set up system set property property source constant apollo bootstrap enable true system set property property source constant apollo bootstrap namespace application yml prepare yaml config file application yml read yaml content as config file property case8 yml 
bootstrap config test before class public static void before class throw exception do set up config config mock config class when config get property name then return set new hash set test bean conditional on key when config get property eq test bean conditional on key any string then return boolean false to string mock config config const namespace application config 
bootstrap config test before class public static void before class throw exception do set up config config mock config class mock config config const namespace application config 
bootstrap config test before class public static void before class do set up system set property property source constant apollo bootstrap enable true system set property property source constant apollo bootstrap eager load enable true config config mock config class mock config config const namespace application config 
standalone profile application listener test before class public static void init system set property naco standalone true 
system util test before class public static void init system set property naco standalone string value of standalone mode system set property naco prefer hostname over ip string value of prefer host mode 
watch file center i t case before class public static void before cl throw exception disk util delete dir then mkdir path 
config a p i c i t case before class after class public static void clean client cache throw exception config clean util clean client cache 
config beta c i t case before class after class public static void clean client cache throw exception config clean util clean client cache 
config export and import a p i c i t case before class after class public static void clean client cache throw exception config clean util clean client cache 
config long poll return change c i t case before class after class public static void clean client cache throw exception config clean util clean client cache 
config long poll c i t case before class after class public static void clean client cache throw exception config clean util clean client cache 
base cluster test before class public static void before throw exception count down latch latch new count down latch runnable runnable for int i i i try url runner url new file console target class to u be i to u be l url url new url runner url u r l class loader cl new u r l class loader url class runner class cl load class com alibaba naco naco run i latch runner class catch exception e latch count down new thread runnable start latch await system out println the cluster node initialization be complete property setting7 new property string server ip7 127.0 0.1 setting7 put property key const server addr server ip7 setting7 put property key const username naco setting7 put property key const password naco iconfig7 naco factory create config service setting7 inaming7 naco factory create naming service setting7 property setting8 new property string server ip8 127.0 0.1 setting8 put property key const server addr server ip8 setting8 put property key const username naco setting8 put property key const password naco iconfig8 naco factory create config service setting8 inaming8 naco factory create naming service setting7 property setting9 new property string server ip9 127.0 0.1 setting9 put property key const server addr server ip9 setting9 put property key const username naco setting9 put property key const password naco iconfig9 naco factory create config service setting9 inaming9 naco factory create naming service setting7 time unit seconds sleep 20 l 
server member manager i t case before class public static void init class throw exception system set property constant naco server ip 127.0 0.1 system set property server port application util set be standalone true application util inject environment new standard environment 
client filter test before class public static void start application client client builder new builder connect timeout time unit seconds read timeout time unit seconds build port socket util find available tcp port host http 127.0 0.1 port spring application spring application new spring application test application class ctx spring application run spring profile active client server port port 
provider filter test before class public static void start application rest assure base path int port socket util find available tcp port rest assure port port spring application spring application new spring application test application class ctx spring application run spring profile active provider server port port 
sentinel annotation interceptor integration test before class public static void init se container initializer container init se container initializer new instance container container init initialize 
http server handler test before class public static void before class throw exception don t execute init executor do init to avoid command center spi load field declare field init executor class get declare field for field declare field declare field if declare field get name equal initialize declare field set accessible true atomic boolean declare field get init executor class set true create netty http command center to create http server command center command center new netty http command center call before start to register handler command center before start 
http server test before class public static void before class note clear handler map first as other test case may init http server handler map if not run mvn test the next assert equal http server handler map size may fail http server handler map clear create new http server http server new http server no handler in handler map at first assert equal http server handler map size 
cli frontend cancel test before class public static void init cli frontend test util pipe system out to null 
cli frontend list test before class public static void init cli frontend test util pipe system out to null 
cli frontend package program test before class public static void init cli frontend test util pipe system out to null 
cli frontend run test before class public static void init cli frontend test util pipe system out to null 
cli frontend stop with savepoint test before class public static void setup cli frontend test util pipe system out to null 
class path package program retriever test before class public static void init throw i o exception final string text file name test txt final string user dir have entry class name test user dir have entry class final string user dir have not entry class name test user dir have not entry class user dir have entry class job dir new folder user dir have entry class name final path user jar path user dir have entry class to path resolve test job info job jar path to file get name final path user lib jar path user dir have entry class to path resolve test job info job lib jar path to file get name user dir have not entry class job dir new folder user dir have not entry class name create file file copy test job info job jar path user jar path file copy test job info job lib jar path user lib jar path file create file user dir have entry class to path resolve text file name file copy test job info job lib jar path user dir have not entry class to path resolve test job info job lib jar path to file get name file create file user dir have not entry class to path resolve text file name final path work directory file util get current work directory array as list user jar path user lib jar path stream map path file util relativize path work directory path map function util unchecked function file util to u be l for each expect u be l add 
rest cluster client savepoint trigger test before class public static void set up throw configuration exception rest server endpoint configuration rest server endpoint configuration from configuration rest config executor executor new single thread executor new executor thread factory rest cluster client savepoint trigger test class get simple name 
cassandra connector i t case before class public static void start cassandra throw i o exception class loader class loader cassandra connector i t case class get class loader file file new file class loader get resource cassandra yaml get file file tmp temporary folder new file cassandra yaml try buffer writer b new buffer writer new file writer tmp copy cassandra yaml inject absolute path into cassandra yaml scanner scanner new scanner file while scanner have next line string line scanner next line line line replace path tmp get parent file b write line n b flush tell cassandra where the configuration file be use the test configuration file system set property cassandra config tmp get absolute file to u be i to string if embed cassandra new embed cassandra service cassandra start start establish a connection within seconds long start system nano time long deadline start 000 l while true try cluster builder get cluster session cluster connect break catch exception e if system nano time deadline throw e try thread sleep catch interrupt exception ignore log debug connection establish after ms system current time millis start session execute create keyspace query session execute create table query replace table name variable table name prefix initial 
bucket sink migration test before class public static void verify o s assume assume true hdf cluster can not be start on window without extension operate system be window 
bucket sink test before class public static void create h d f s throw i o exception assume assume true hdf cluster can not be start on window without extension operate system be window configuration conf new configuration file datum dir temp folder new folder conf set mini d f s cluster hdf minidf basedir datum dir get absolute path mini d f s cluster builder builder new mini d f s cluster builder conf hdf cluster builder build dfs hdf cluster get file system hdf u be i hdfs net util host and port to url string hdfs cluster get u r i get host hdf cluster get name node port 
string writer test before class public static void create h d f s throw i o exception org apache hadoop conf configuration conf new org apache hadoop conf configuration file datum dir temporary folder new folder conf set mini d f s cluster hdf minidf basedir datum dir get absolute path mini d f s cluster builder builder new mini d f s cluster builder conf hdf cluster builder build dfs hdf cluster get file system output dir hdf net util host and port to url string hdfs cluster get u r i get host hdf cluster get name node port 
h base test base before class public static void activate h base cluster throw i o exception prepare table 
h base testing cluster auto starter before class public static void set up throw exception h base 1.4 do not work with hadoop because it use guava 12.0 hadoop use guava 27.0 jre there be no guava version in between that work with both assume assume true this test be skip for hadoop version above version util compare version system get property hadoop version 3.0 log info h base minicluster start test util start mini cluster https issue apache org jira browse hbase test util get configuration set int hbase master info port make sure the zookeeper quorum value contain the right port number vary per run log info hbase minicluster client port test util get zk cluster get client port test util get configuration set hbase zookeeper quorum localhost test util get zk cluster get client port conf initialize test util get configuration log info h base minicluster running 
hive table factory test before class public static void init catalog hive test util create hive catalog catalog open 
hive table sink i t case before class public static void create catalog throw i o exception hive conf hive shell get hive conf hive catalog hive test util create hive catalog hive conf hive catalog open 
hive table source i t case before class public static void create catalog throw i o exception hive conf hive shell get hive conf hive catalog hive test util create hive catalog hive conf hive catalog open 
table env hive connector i t case before class public static void setup hive conf hive conf hive shell get hive conf hive catalog hive test util create hive catalog hive conf hive catalog open hm client hive metastore client factory create hive conf hive shim loader get hive version 
hive catalog datum type test before class public static void init catalog hive test util create hive catalog catalog open 
hive catalog generic metadata test before class public static void init catalog hive test util create hive catalog catalog open 
hive catalog hive metadata test before class public static void init catalog hive test util create hive catalog catalog open 
hive catalog i t case before class public static void create catalog hive conf hive shell get hive conf hive catalog hive test util create hive catalog hive conf hive catalog open 
hive catalog use blink i t case before class public static void create catalog hive conf hive conf hive shell get hive conf hive catalog hive test util create hive catalog hive conf hive catalog open 
hive module test before class public static void init assume true hive or later 
jdbc catalog factory test before class public static void setup throw s q l exception jdbc postgresql localhost postgre user postgre string embed jdbc url pg get embed postgre get jdbc url test username test pwd jdbc postgresql localhost base url embed jdbc url substr embed jdbc url last index of catalog new jdbc catalog test catalog name postgre catalog default database test username test pwd base url 
postgre catalog test base before class public static void init throw s q l exception jdbc postgresql localhost postgre user postgre string embed jdbc url pg get embed postgre get jdbc url test username test pwd jdbc postgresql localhost base url embed jdbc url substr embed jdbc url last index of catalog new postgre catalog test catalog name postgre catalog default database test username test pwd base url create test database and schema create database test db create schema test db test schema create test table table postgre public t1 table postgre public t4 table postgre public t5 create table postgre table path from flink table name t a b l e1 get simple table pg schema sql create table postgre table path from flink table name t a b l e4 get simple table pg schema sql create table postgre table path from flink table name t a b l e5 get simple table pg schema sql table test public t2 table test test schema t3 table postgre public dt table postgre public dt2 create table test db postgre table path from flink table name t a b l e2 get simple table pg schema sql create table test db new postgre table path test schema t a b l e3 get simple table pg schema sql create table postgre table path from flink table name table primitive type get primitive table pg schema sql create table postgre table path from flink table name table primitive t y p e2 get primitive table test pk2 pg schema sql create table postgre table path from flink table name table array type get array table pg schema sql create table postgre table path from flink table name table serial type get serial table pg schema sql execute s q l postgre catalog default database string format insert into public s value s t a b l e1 get simple table value execute s q l postgre catalog default database string format insert into s value s table primitive type get primitive table value execute s q l postgre catalog default database string format insert into s value s table array type get array table value execute s q l postgre catalog default database string format insert into s value s table serial type get serial table value 
flink kafka internal producer i t case before class public static void prepare throw exception log info log info start kafka test base log info property server property new property server property put transaction state log num partition integer to string server property put auto leader rebalance enable boolean to string false start cluster kafka test environment create config set kafka server number number of kafka server set secure mode false set hide kafka behind proxy true set kafka server property server property 
kafka i t case before class public static void prepare throw exception kafka producer test base prepare kafka test environment impl kafka server set producer semantic flink kafka producer semantic at least once 
kafka producer at least once i t case before class public static void prepare throw exception kafka producer test base prepare kafka test environment impl kafka server set producer semantic flink kafka producer semantic at least once 
kafka producer exactly once i t case before class public static void prepare throw exception kafka producer test base prepare kafka test environment impl kafka server set producer semantic flink kafka producer semantic exactly once 
kafka shuffle test base before class public static void prepare throw exception kafka producer test base prepare kafka test environment impl kafka server set producer semantic flink kafka producer semantic exactly once 
kafka010 secure run i t case before class public static void prepare throw exception log info log info start kafka010 secure run i t case log info secure test environment prepare temp folder secure test environment populate flink secure configuration get flink configuration start cluster true false 
flink kafka producer i t case before class public static void prepare throw exception log info log info start kafka test base log info property server property new property server property put transaction state log num partition integer to string server property put auto leader rebalance enable boolean to string false start cluster kafka test environment create config set kafka server number number of kafka server set secure mode false set hide kafka behind proxy true set kafka server property server property 
kafka011 i t case before class public static void prepare throw exception kafka producer test base prepare kafka test environment impl kafka server set producer semantic flink kafka producer011 semantic at least once 
kafka011 producer at least once i t case before class public static void prepare throw exception kafka producer test base prepare kafka test environment impl kafka server set producer semantic flink kafka producer011 semantic at least once 
kafka011 producer exactly once i t case before class public static void prepare throw exception kafka producer test base prepare kafka test environment impl kafka server set producer semantic flink kafka producer011 semantic exactly once 
kafka migration test base before class public static void prepare throw exception 
kafka short retention test base before class public static void prepare throw exception log info log info start kafka short retention test base log info dynamically load the implementation for the test class clazz class for name org apache flink streaming connector kafka kafka test environment impl kafka server kafka test environment instantiation util instantiate clazz log info start kafka test base prepare for kafka kafka server get version if kafka server be secure run support secure prop kafka server get secure property property specific property new property specific property set property log retention hour specific property set property log retention minute specific property set property log retention ms specific property set property log retention check interval ms kafka server prepare kafka server create config set kafka server property specific property standard prop kafka server get standard property 
kafka test base before class public static void prepare throw exception prepare true 
job manager watermark tracker test before class public static void set up throw exception final configuration config new configuration config set integer rest option port final mini cluster configuration mini cluster configuration new mini cluster configuration builder set configuration config set num task manager set num slot per task manager build flink new mini cluster mini cluster configuration flink start 
delimit input format sampling test before class public static void initialize try test temp folder temp folder new folder make sure we do sample config test config util load global conf new string optimizer option delimit format min line sample key optimizer option delimit format max line sample key new string test temp folder catch throwable t assert fail could not load the global configuration 
row comparator test before class public static void init todo we can not test null here as pojo comparator have no support for null key test pojo1 name test pojo2 name test1 test pojo3 name test2 
row comparator with many field test before class public static void set up throw exception type information field type new type information number of field for int i i number of field i field type i basic type info string type info type info new row type info field type 
plugin config test before class public static void setup old env variable system getenv 
java bash test base before class public static void check operate system assume assume true this test check shell script which be not available on window operate system be window 
check pub sub emulator test before class public static void set up throw exception pubsub helper get pubsub helper pubsub helper create topic project name topic name pubsub helper create subscription project name subscription name project name topic name 
emulate pub sub sink test before class public static void set up throw exception pubsub helper get pubsub helper pubsub helper create topic project name topic name pubsub helper create subscription project name subscription name project name topic name 
emulate pub sub source test before class public static void set up throw exception pubsub helper get pubsub helper pubsub helper create topic project name topic name pubsub helper create subscription project name subscription name project name topic name 
g cloud unit test base before class public static void launch g cloud emulator throw exception separate out into separate class so the entire test class to be serializable g cloud emulator manager launch docker 
allround mini cluster test before class public static void before class org apache log4j property configurator configure allround mini cluster test class get class loader get resource log4j property 
test util test before class public static void setup class operate system restriction forbid symbolic link usually require special permission on window operate system window 
metric availability i t case before class public static void start executor schedule executor service executor new schedule thread pool 
prometheus reporter end to end i t case before class public static void check o s assume assume false this test do not run on window operate system be window 
azure file system behavior i t case before class public static void check credentials and setup throw i o exception check whether credentials and container detail exist assume assume true azure container not configure skip test string util be null or whitespace only container assume assume true azure access key not configure skip test string util be null or whitespace only access key initialize configuration with valid credentials final configuration conf new configuration f azure account key youraccount blob core window net access key conf set string f azure account key account blob core window net access key file system initialize conf 
hadoop recoverable writer old hadoop with no truncate support test before class public static void test hadoop version assume assume true hadoop util be max hadoop version 
hadoop recoverable writer old hadoop with no truncate support test before class public static void verify o s assume assume true hdf cluster can not be start on window without extension operate system be window 
hadoop recoverable writer old hadoop with no truncate support test before class public static void create h d f s throw exception final file base dir temp folder new folder final configuration hd conf new configuration hd conf set mini d f s cluster hdf minidf basedir base dir get absolute path final mini d f s cluster builder builder new mini d f s cluster builder hd conf hdf cluster builder build final org apache hadoop f file system hdf hdf cluster get file system file system new hadoop file system hdfs base path new path hdf get uri test 
hadoop recoverable writer test before class public static void test hadoop version assume assume true hadoop util be min hadoop version 
hadoop recoverable writer test before class public static void verify o s assume assume true hdf cluster can not be start on window without extension operate system be window 
hadoop recoverable writer test before class public static void create h d f s throw exception final file base dir temp folder new folder final configuration hd conf new configuration hd conf set mini d f s cluster hdf minidf basedir base dir get absolute path final mini d f s cluster builder builder new mini d f s cluster builder hd conf hdf cluster builder build final org apache hadoop f file system hdf hdf cluster get file system file system new hadoop file system hdfs base path new path hdf get uri test 
hdf behavior test before class public static void verify o s assume assume true hdf cluster can not be start on window without extension operate system be window 
hdf behavior test before class public static void create h d f s throw exception final file base dir tmp new folder configuration hd conf new configuration hd conf set mini d f s cluster hdf minidf basedir base dir get absolute path mini d f s cluster builder builder new mini d f s cluster builder hd conf hdf cluster builder build org apache hadoop f file system hdf hdf cluster get file system f new hadoop file system hdfs base path new path hdf get uri to string test 
hadoop utils test before class public static void set property to enable kerbero config init throw krb exception system set property java security krb5 realm system set property java security krb5 kdc system set property java security krb5 conf dev null sun security krb5 config refresh 
hadoop o s s file system behavior i t case before class public static void setup throw i o exception o s s test credentials assume credentials available final configuration conf new configuration conf set string fs oss endpoint o s s test credentials get o s s endpoint conf set string fs oss access key id o s s test credentials get o s s access key conf set string fs oss access key secret o s s test credentials get o s s secret key file system initialize conf 
hadoop o s s file system i t case before class public static void setup throw i o exception o s s test credentials assume credentials available final configuration conf new configuration conf set string fs oss endpoint o s s test credentials get o s s endpoint conf set string fs oss access key id o s s test credentials get o s s access key conf set string fs oss access key secret o s s test credentials get o s s secret key file system initialize conf base path new path o s s test credentials get test bucket uri test datum dir fs base path get file system consistency tolerance n s 
hadoop s3 file system behavior i t case before class public static void check credentials and setup throw i o exception check whether credentials exist s3 test credentials assume credentials available initialize configuration with valid credentials final configuration conf new configuration conf set string s3 access key s3 test credentials get s3 access key conf set string s3 secret key s3 test credentials get s3 secret key file system initialize conf 
hadoop s3 file system i t case before class public static void setup throw i o exception check whether credentials exist s3 test credentials assume credentials available initialize configuration with valid credentials final configuration conf new configuration conf set string s3 access key s3 test credentials get s3 access key conf set string s3 secret key s3 test credentials get s3 secret key file system initialize conf base path new path s3 test credentials get test bucket uri test uuid random u u i d fs base path get file system consistency tolerance n s 000 l seconds check for uniqueness of the test directory directory must not yet exist assert false f exist base path 
hadoop s3 recoverable writer exception i t case before class public static void check credentials and setup throw i o exception check whether credentials exist s3 test credentials assume credentials available base path new path s3 test credentials get test bucket uri test uuid random u u i d initialize configuration with valid credentials final configuration conf new configuration conf set string s3 access key s3 test credentials get s3 access key conf set string s3 secret key s3 test credentials get s3 secret key conf set long part upload min size part upload min size value conf set integer max concurrent upload max concurrent upload value final string default tmp dir temp folder get root get absolute path s3 tmp dir conf set string core option tmp dir default tmp dir file system initialize conf skip false 
hadoop s3 recoverable writer i t case before class public static void check credentials and setup throw i o exception check whether credentials exist s3 test credentials assume credentials available base path new path s3 test credentials get test bucket uri test uuid random u u i d initialize configuration with valid credentials final configuration conf new configuration conf set string s3 access key s3 test credentials get s3 access key conf set string s3 secret key s3 test credentials get s3 secret key conf set long part upload min size part upload min size value conf set integer max concurrent upload max concurrent upload value final string default tmp dir temp folder get root get absolute path s3 tmp dir conf set string core option tmp dir default tmp dir file system initialize conf skip false 
presto s3 file system behavior i t case before class public static void check credentials and setup throw i o exception check whether credentials exist s3 test credentials assume credentials available initialize configuration with valid credentials final configuration conf new configuration conf set string s3 access key s3 test credentials get s3 access key conf set string s3 secret key s3 test credentials get s3 secret key file system initialize conf 
presto s3 file system i t case before class public static void setup throw i o exception s3 test credentials assume credentials available initialize configuration with valid credentials final configuration conf new configuration conf set string s3 access key s3 test credentials get s3 access key conf set string s3 secret key s3 test credentials get s3 secret key file system initialize conf base path new path s3 test credentials get test bucket uri test datum dir fs base path get file system consistency tolerance n s 000 l seconds check for uniqueness of the test directory directory must not yet exist assert false f exist base path 
presto s3 recoverable writer test before class public static void check credentials and setup throw i o exception check whether credentials exist s3 test credentials assume credentials available initialize configuration with valid credentials final configuration conf new configuration conf set string s3 access key s3 test credentials get s3 access key conf set string s3 secret key s3 test credentials get s3 secret key conf set long part upload min size part upload min size value conf set integer max concurrent upload max concurrent upload value final string default tmp dir conf get string core option tmp dir s3 tmp dir conf set string core option tmp dir default tmp dir file system initialize conf 
hadoop swift file system i t case before class public static void check credentials and setup throw i o exception check whether credentials exist assume assume true swift container not configure skip test container null assume assume true swift username not configure skip test username null assume assume true swift password not configure skip test password null assume assume true swift tenant not configure skip test tenant null assume assume true swift region not configure skip test region null initialize configuration with valid credentials final configuration conf create configuration file system initialize conf check for uniqueness of the test directory final path directory new path swift container servicename test datum dir final file system f directory get file system directory must not yet exist assert false f exist directory reset configuration file system initialize new configuration skip test false 
avro external jar program i t case before class public static void set up throw exception mini cluster start 
compress writer factory test before class public static void before conf with custom codec new configuration conf with custom codec set io compression codec org apache flink format compress custom compression codec 
hadoop rename committer h d f s test before class public static void create h d f s throw exception assume assume true operating system be window hdf cluster new h d f s cluster class temporary folder new folder 
parquet table source i t case before class public static void setup throw exception test path create test parquet file 
parquet table source test before class public static void setup throw exception test path create test parquet file 
continuous file processing migration test before class public static void verify o s assume assume true hdf cluster can not be start on window without extension operate system be window 
continuous file processing test before class public static void create h d f s assume assume true hdf cluster can not be start on window without extension operate system be window try file hdf dir temp folder new folder org apache hadoop conf configuration hd conf new org apache hadoop conf configuration hd conf set mini d f s cluster hdf minidf basedir hdfs dir get absolute path hd conf set dfs block size string value of this be the minimum we can set mini d f s cluster builder builder new mini d f s cluster builder hd conf hdf cluster builder build hdf u be i hdf hdf cluster get u be i get host hdf cluster get name node port hdf new org apache hadoop f path hdf u be i get file system hd conf catch throwable e e print stack trace assert fail test fail e get message 
distribute cache df test before class public static void setup throw exception file datum dir temp folder new folder conf set mini d f s cluster hdf minidf basedir datum dir get absolute path mini d f s cluster builder builder new mini d f s cluster builder conf hdf cluster builder build string hdf u be i hdfs net util host and port to url string hdfs cluster get u r i get host hdf cluster get name node port file system df file system get new uri hdf u be i test file write file df df get home directory test file test dir new path df get home directory test dir dfs mkdir test dir write file df test dir test file1 write file df test dir test file2 
h d f s test before class public static void verify o s assume assume true hdf cluster can not be start on window without extension operate system be window 
co group operator test before class public static void insert custom datum custom type datum add new custom type 
cross operator test before class public static void insert custom datum custom type datum add new custom type 
join operator test before class public static void insert custom datum custom type datum add new custom type custom type with tuple datum add new custom type with tuple custom nest type datum add new nest custom type 
random sampler test before class public static void init initiate source datum set for int i i source size i source add double i 
slf4j reporter test before class public static void set up configuration configuration new configuration configuration set string metric option scope name task host tm id job name registry new metric registry impl metric registry configuration from configuration configuration collection singleton list reporter setup for reporter slf4j new slf4j reporter delimiter registry get delimiter task metric group new task manager metric group registry host name task manager id add task for job new job i d job name new job vertex i d new execution attempt i d task name reporter slf4j reporter registry get reporter get 
process python environment manager test before class public static void prepare temp directory throw i o exception file tmp file file create temp file process environment manager test if tmp file delete tmp file mkdir tmp dir tmp file get absolute path else throw new i o exception create temp directory tmp file get absolute path fail for int i i i file distribute file new file tmp dir file i try file output stream out new file output stream distribute file out write i for int i i i file distribute directory new file tmp dir dir i if distribute directory mkdir for int j j j file file in dir new file tmp dir dir i file separator file j try file output stream out new file output stream file in dir out write i out write j else throw new i o exception create temp dir distribute directory get absolute path fail be unix operating system be free b s d operating system be linux operating system be mac operating system be solaris for int i i i file zip file new file tmp dir zip i try zip archive output stream zip out new zip archive output stream new file output stream zip file zip archive entry zipfile0 new zip archive entry zip dir i zipfile0 zipfile0 set unix mode zip out put archive entry zipfile0 zip out write new byte zip out close archive entry zip archive entry zipfile1 new zip archive entry zip dir i zipfile1 zipfile1 set unix mode zip out put archive entry zipfile1 zip out write new byte zip out close archive entry file zip expect new file string join file separator tmp dir zip expect i zip dir i if zip expect mkdir throw new i o exception create temp dir zip expect get absolute path fail file zipfile0 new file zip expect zipfile0 try file output stream out new file output stream zipfile0 out write new byte file zipfile1 new file zip expect zipfile1 try file output stream out new file output stream zipfile1 out write new byte if be unix if zipfile0 set readable true true zipfile0 set writable true true zipfile0 set executable true throw new i o exception set unixmode to temp file zipfile0 get absolute path fail if zipfile1 set readable true zipfile1 set writable true true zipfile1 set executable false throw new i o exception set unixmode to temp file zipfile1 get absolute path fail 
arrow util test before class public static void init test field new array list test field add tuple7 of f1 new tiny int type new arrow type int true row tiny int writer class tiny int writer tiny int writer for row class tiny int field reader class arrow tiny int column vector class test field add tuple7 of f2 new small int type new arrow type int true row small int writer class small int writer small int writer for row class small int field reader class arrow small int column vector class test field add tuple7 of f3 new int type new arrow type int true row int writer class int writer int writer for row class int field reader class arrow int column vector class test field add tuple7 of f4 new big int type new arrow type int true row big int writer class big int writer big int writer for row class big int field reader class arrow big int column vector class test field add tuple7 of f5 new boolean type new arrow type bool row boolean writer class boolean writer boolean writer for row class boolean field reader class arrow boolean column vector class test field add tuple7 of f6 new float type new arrow type float point float point precision single row float writer class float writer float writer for row class float field reader class arrow float column vector class test field add tuple7 of f7 new double type new arrow type float point float point precision double row double writer class double writer double writer for row class double field reader class arrow double column vector class test field add tuple7 of f8 new var char type arrow type utf8 instance row var char writer class var char writer var char writer for row class var char field reader class arrow var char column vector class test field add tuple7 of f9 new var binary type arrow type binary instance row var binary writer class var binary writer var binary writer for row class var binary field reader class arrow var binary column vector class test field add tuple7 of f10 new decimal type new arrow type decimal row decimal writer class decimal writer decimal writer for row class decimal field reader class arrow decimal column vector class test field add tuple7 of f11 new date type new arrow type date date unit day row date writer class date writer date writer for row class date field reader class arrow date column vector class test field add tuple7 of f13 new time type new arrow type time time unit second row time writer class time writer time writer for row class time field reader class arrow time column vector class test field add tuple7 of f14 new time type new arrow type time time unit millisecond row time writer class time writer time writer for row class time field reader class arrow time column vector class test field add tuple7 of f15 new time type new arrow type time time unit microsecond row time writer class time writer time writer for row class time field reader class arrow time column vector class test field add tuple7 of f16 new time type new arrow type time time unit nanosecond row time writer class time writer time writer for row class time field reader class arrow time column vector class test field add tuple7 of f17 new local zone timestamp type new arrow type timestamp time unit second null row timestamp writer class timestamp writer timestamp writer for row class timestamp field reader class arrow timestamp column vector class test field add tuple7 of f18 new local zone timestamp type new arrow type timestamp time unit millisecond null row timestamp writer class timestamp writer timestamp writer for row class timestamp field reader class arrow timestamp column vector class test field add tuple7 of f19 new local zone timestamp type new arrow type timestamp time unit microsecond null row timestamp writer class timestamp writer timestamp writer for row class timestamp field reader class arrow timestamp column vector class test field add tuple7 of f20 new local zone timestamp type new arrow type timestamp time unit nanosecond null row timestamp writer class timestamp writer timestamp writer for row class timestamp field reader class arrow timestamp column vector class test field add tuple7 of f21 new timestamp type new arrow type timestamp time unit second null row timestamp writer class timestamp writer timestamp writer for row class timestamp field reader class arrow timestamp column vector class test field add tuple7 of f22 new timestamp type new arrow type timestamp time unit millisecond null row timestamp writer class timestamp writer timestamp writer for row class timestamp field reader class arrow timestamp column vector class test field add tuple7 of f23 new timestamp type new arrow type timestamp time unit microsecond null row timestamp writer class timestamp writer timestamp writer for row class timestamp field reader class arrow timestamp column vector class test field add tuple7 of f24 new timestamp type new arrow type timestamp time unit nanosecond null row timestamp writer class timestamp writer timestamp writer for row class timestamp field reader class arrow timestamp column vector class test field add tuple7 of f25 new array type new var char type arrow type list instance row array writer class array writer array writer for row class array field reader class arrow array column vector class row type row field type new row type array as list new row type row field a new int type new row type row field b new var char type new row type row field c new array type new var char type new row type row field d new timestamp type new row type row field e new row type array as list new row type row field e1 new int type new row type row field e2 new var char type test field add tuple7 of f26 row field type arrow type struct instance row row writer class row writer row writer for row class row field reader class arrow row column vector class list row type row field row field new array list for tuple7 string logical type arrow type class class class class field test field row field add new row type row field field f0 field f1 row type new row type row field allocator arrow util get root allocator new child allocator stdout long max value 
row arrow reader writer test before class public static void init list logical type field type new array list field type add new tiny int type field type add new small int type field type add new int type field type add new big int type field type add new boolean type field type add new float type field type add new double type field type add new var char type field type add new var binary type field type add new decimal type field type add new date type field type add new time type field type add new time type field type add new time type field type add new time type field type add new local zone timestamp type field type add new local zone timestamp type field type add new local zone timestamp type field type add new local zone timestamp type field type add new timestamp type field type add new timestamp type field type add new timestamp type field type add new timestamp type field type add new array type new var char type field type add new row type array as list new row type row field a new int type new row type row field b new var char type new row type row field c new array type new var char type new row type row field d new timestamp type new row type row field e new row type array as list new row type row field e1 new int type new row type row field e2 new var char type list row type row field row field new array list for int i i field type size i row field add new row type row field f i field type get i row type new row type row field allocator arrow util get root allocator new child allocator stdout long max value 
row datum arrow reader writer test before class public static void init field type add new tiny int type field type add new small int type field type add new int type field type add new big int type field type add new boolean type field type add new float type field type add new double type field type add new var char type field type add new var binary type field type add new decimal type field type add new date type field type add new time type field type add new time type field type add new time type field type add new time type field type add new local zone timestamp type field type add new local zone timestamp type field type add new local zone timestamp type field type add new local zone timestamp type field type add new timestamp type field type add new timestamp type field type add new timestamp type field type add new timestamp type field type add new array type new var char type row field type new row type array as list new row type row field a new int type new row type row field b new var char type new row type row field c new array type new var char type new row type row field d new timestamp type new row type row field e new row type array as list new row type row field e1 new int type new row type row field e2 new var char type field type add row field type list row type row field row field new array list for int i i field type size i row field add new row type row field f i field type get i row type new row type row field allocator arrow util get root allocator new child allocator stdout long max value 
arrow source function test before class public static void init field type add new var char type list row type row field row field new array list for int i i field type size i row field add new row type row field f i field type get i row type new row type row field datum type type conversion from logical to datum type row type serializer new row datum serializer new execution config field type to array new logical type allocator arrow util get root allocator new child allocator stdout long max value 
row arrow source function test before class public static void init field type add new var char type list row type row field row field new array list for int i i field type size i row field add new row type row field f i field type get i row type new row type row field datum type type conversion from logical to datum type row type allocator arrow util get root allocator new child allocator stdout long max value 
h a queryable state f backend i t case before class public static void setup throw exception zk server new testing server we have to manage this manually because we have to create the zoo keeper server ahead of this mini cluster resource new mini cluster with client resource new mini cluster resource configuration builder set configuration get config set number task manager num tm set number slot per task manager num slot per tm build mini cluster resource before client new queryable state client localhost q proxy port range start cluster client mini cluster resource get cluster client 
h a queryable state rock d b backend i t case before class public static void setup throw exception zk server new testing server we have to manage this manually because we have to create the zoo keeper server ahead of this mini cluster resource new mini cluster with client resource new mini cluster resource configuration builder set configuration get config set number task manager num tm set number slot per task manager num slot per tm build mini cluster resource before client new queryable state client localhost q proxy port range start cluster client mini cluster resource get cluster client 
non h a queryable state f backend i t case before class public static void setup throw exception client new queryable state client localhost q proxy port range start cluster client mini cluster resource get cluster client 
non h a queryable state rock d b backend i t case before class public static void setup throw exception client new queryable state client localhost q proxy port range start cluster client mini cluster resource get cluster client 
kv state server handler test before class public static void setup try test server new kv state server impl inet address get local host get host name collection singleton list iterator new kv state registry new disabled kv state request stats test server start catch throwable e e print stack trace 
blob client ssl test before class public static void start s s l server throw i o exception configuration config s s l util test create internal ssl config with key and trust store security option ssl provider default value config set string blob server option storage directory temporary ssl folder new folder get absolute path blob ssl server new test blob server config new void blob store blob ssl server start ssl client config config 
blob client ssl test before class public static void start non s s l server throw i o exception configuration config s s l util test create internal ssl config with key and trust store security option ssl provider default value config set string blob server option storage directory temporary ssl folder new folder get absolute path config set boolean blob server option ssl enable false blob non ssl server new blob server config new void blob store blob non ssl server start non ssl client config config 
blob client test before class public static void start server throw i o exception configuration config new configuration config set string blob server option storage directory temporary folder new folder get absolute path blob server new test blob server config new void blob store blob server start client config new configuration 
client util test before class public static void setup throw i o exception configuration config new configuration config set string blob server option storage directory temporary folder new folder get absolute path blob server new blob server config new void blob store blob server start 
dispatcher resource cleanup test before class public static void setup class rpc service new testing rpc service 
dispatcher test before class public static void setup class rpc service new testing rpc service 
mini dispatcher test before class public static void setup class throw i o exception job graph new job graph archive execution graph new archive execution graph builder set job i d job graph get job i d set state job status finish build rpc service new testing rpc service configuration new configuration configuration set string blob server option storage directory temporary folder new folder get absolute path blob server new blob server configuration new void blob store 
session dispatcher leader process test before class public static void setup class io executor executor new single thread executor 
file job graph retriever test before class public static void init throw i o exception final path job graph path temporary folder new file job graph file path default value to path jar file in job graph temporary folder new file jar file in job graph jar to path final job vertex source new job vertex source final job vertex target new job vertex target final job graph job graph new job graph new job i d test source target job graph set classpath collection singleton list jar file in job graph to uri to u be l try object output stream object output stream new object output stream file new output stream job graph path create object output stream write object job graph final configuration cfg new configuration cfg set string job graph file path key job graph path to string configuration new unmodifiable configuration cfg 
archive execution graph test before class public static void setup execution graph throw exception setup job vertex i d v1 i d new job vertex i d job vertex i d v2 i d new job vertex i d job vertex v1 new job vertex v1 v1 i d job vertex v2 new job vertex v2 v2 i d v1 set parallelism v2 set parallelism v1 set invokable class abstract invokable class v2 set invokable class abstract invokable class job graph job graph new job graph v1 v2 execution config config new execution config config set execution mode execution mode batch force config set restart strategy new restart strategy no restart strategy configuration config set parallelism config enable object reuse config set global job parameter new test job parameter job graph set execution config config runtime graph testing execution graph builder new builder set job graph job graph build runtime graph start component main thread executor service adapter for main thread list execution job vertex job vertex new array list job vertex add runtime graph get job vertex v1 i d job vertex add runtime graph get job vertex v2 i d checkpoint stats tracker stats tracker new checkpoint stats tracker job vertex mock checkpoint coordinator configuration class new unregistered metric group checkpoint coordinator configuration chk config new checkpoint coordinator configuration checkpoint retention policy never retain after termination true false false runtime graph enable checkpoint chk config collection execution job vertex empty list collection execution job vertex empty list collection execution job vertex empty list collection master trigger restore hook empty list new standalone checkpoint i would counter new standalone complete checkpoint store new memory state backend stats tracker runtime graph set json plan runtime graph get job vertex v2 i d get task vertex get current execution attempt fail new runtime exception this exception be throw on purpose 
execution graph not enough resource test before class public static void setup class main thread executor resource new testing component main thread executor resource main thread executor resource before main thread executor main thread executor resource get component main thread test executor get main thread executor 
zoo keeper ha service test before class public static void setup class client start curator framework client start 
partition request queue test before class public static void set up throw exception file channel manager new file channel manager impl new string temporary folder new folder get absolute path testing 
netty shuffle environment test before class public static void set up file channel manager new file channel manager impl new string temp dir testing 
bound block subpartition test before class public static void set up file channel manager new file channel manager impl new string temp dir testing 
bound block subpartition write read test before class public static void set up file channel manager new file channel manager impl new string temp dir testing 
file channel bind datum test before class public static void set up file channel manager new file channel manager impl new string temp dir testing 
result partition factory test before class public static void set up file channel manager new file channel manager impl new string temp dir testing 
result partition test before class public static void set up file channel manager new file channel manager impl new string temp dir testing 
blob cleanup i t case before class public static void setup throw exception blob base dir temporary folder new folder configuration cfg new configuration cfg set string blob server option storage directory blob base dir get absolute path cfg set string restart strategy option restart strategy fixeddelay cfg set integer restart strategy option restart strategy fix delay attempt b l o bs be delete from blob cache between 1 and 2 after last reference the blob cache may still have the blob or not let s test both case randomly cfg set long blob server option cleanup interval 1 l configuration new unmodifiable configuration cfg mini cluster resource new mini cluster resource new mini cluster resource configuration builder set number slot per task manager set number task manager set configuration configuration build mini cluster resource before 
job manager runner impl test before class public static void setup class default job master service factory new testing job master service factory final job vertex job vertex new job vertex test vertex job vertex set invokable class no op invokable class job graph new job graph job vertex archive execution graph new archive execution graph builder set job i d job graph get job i d set state job status finish build 
job master partition release test before class public static void setup class rpc service new testing rpc service 
job master test before class public static void setup class rpc service new testing rpc service fast heartbeat service new heartbeat service fast heartbeat interval fast heartbeat timeout heartbeat service new heartbeat service heartbeat interval heartbeat timeout 
bulk slot provider impl test before class public static void setup class single thread schedule executor service executor new single thread schedule executor main thread executor component main thread executor service adapter for single thread executor single thread schedule executor service 
slot pool batch slot request test before class public static void setup class single thread schedule executor service executor new single thread schedule executor main thread executor component main thread executor service adapter for single thread executor single thread schedule executor service 
leader change cluster component test before class public static void setup class throw exception high availability service new testing embed ha service test util default executor mini cluster new testing mini cluster new testing mini cluster configuration builder set num task manager num tm set num slot per task manager slot per tm build high availability service mini cluster start 
metric query service test before class public static void setup class rpc service new testing rpc service 
coordinator event exactly once i t case before class public static void start mini cluster throw exception final configuration config new configuration config set string rest option bind port final mini cluster configuration cluster cfg new mini cluster configuration builder set num task manager set num slot per task manager set configuration config build mini cluster new mini cluster cluster cfg mini cluster start 
bloom filter test before class public static void init int bit size bloom filter optimal num of bit input size false positive probability bit size bit size long size bit size long size int byte size bit size memory segment memory segment memory segment factory allocate unpool segment byte size bloom filter new bloom filter input size byte size bloom filter set bit location memory segment 
resource manager partition lifecycle test before class public static void setup class rpc service new testing rpc service 
resource manager task executor test before class public static void setup class rpc service new testing rpc service 
resource manager test before class public static void setup class rpc service new testing rpc service 
job manager log list handler test before class public static void setup class throw handler request exception test request new handler request empty request body get instance empty message parameter get instance collection empty map collection empty map 
back pressure request coordinator test before class public static void set up throw exception executor service new schedule thread pool executor 
default execution graph cache test before class public static void setup expect execution graph new archive execution graph builder build 
abstract task manager file handler test before class public static void setup throw i o exception handler request exception final configuration configuration new configuration configuration set string blob server option storage directory temporary folder new folder get absolute path blob server new blob server configuration new void blob store handler request new handler request empty request body get instance new task manager file message parameter collection singleton map task manager id path parameter key expect task manager id get resource id string collection empty map 
rest client multipart test before class public static void setup client throw configuration exception rest client new rest client rest client configuration from configuration new configuration testing util default executor 
akka rpc actor handshake test before class public static void setup class final actor system actor system1 akka util create default actor system final actor system actor system2 akka util create default actor system final actor system wrong version actor system akka util create default actor system akka rpc service configuration akka rpc service config akka rpc service configuration default configuration akka rpc service1 new akka rpc service actor system1 akka rpc service config akka rpc service2 new akka rpc service actor system2 akka rpc service config wrong version akka rpc service new wrong version akka rpc service wrong version actor system akka rpc service configuration default configuration 
akka rpc actor oversized response message test before class public static void setup class throw exception final configuration configuration new configuration configuration set string akka option framesize framesize b rpc service1 akka rpc service util remote service builder configuration localhost create and start rpc service2 akka rpc service util remote service builder configuration localhost create and start 
akka rpc actor test before class public static void setup akka rpc service new testing rpc service 
akka rpc service test before class public static void setup actor system akka util create default actor system akka rpc service new akka rpc service actor system akka rpc service configuration default configuration 
message serialization test before class public static void setup throw exception configuration configuration new configuration configuration set string akka option framesize max frame size b akka rpc service1 akka rpc service util remote service builder configuration localhost create and start akka rpc service2 akka rpc service util remote service builder configuration localhost create and start 
timeout call stack test before class public static void setup actor system akka util create default actor system rpc service new akka rpc service actor system akka rpc service configuration default configuration 
fence rpc endpoint test before class public static void setup rpc service new testing rpc service 
rpc endpoint test before class public static void setup actor system akka util create default actor system rpc service new akka rpc service actor system akka rpc service configuration default configuration 
default scheduler batch scheduling test before class public static void setup class single thread schedule executor service executor new single thread schedule executor main thread executor component main thread executor service adapter for single thread executor single thread schedule executor service 
checkpoint stream with result provider test before class public static void before class throw i o exception temporary folder new temporary folder temporary folder create 
snapshot directory test before class public static void before class throw i o exception temporary folder new temporary folder temporary folder create 
back pressure sample service test before class public static void set up throw exception schedule executor service executor new single thread schedule executor final schedule executor schedule executor new schedule executor service adapter schedule executor service back pressure sample service new back pressure sample service time millisecond schedule executor 
task executor partition lifecycle test before class public static void setup class rpc new testing rpc service 
address resolution test before class public static void check check precondition 
rpc gateway retriever test before class public static void setup rpc service new testing rpc service 
jar plan handler parameter test before class public static void setup throw exception init handler new jar plan handler gateway retriever timeout response header jar plan get header get instance jar dir new configuration executor job graph last submit job graph reference set job graph return new job plan info json plan generator generate plan job graph 
jar run handler parameter test before class public static void setup throw exception init final gateway retriever testing dispatcher gateway gateway retriever completable future complete future restful gateway final time timeout time seconds final map string string response header collection empty map final executor executor testing util default executor final path jar location path get system get property target dir final string parameter program with eager sink parameter program with eager sink jar jar with eager sink file copy jar location resolve parameter program with eager sink jar dir resolve program with eager sink jar handler new jar run handler gateway retriever timeout response header jar run header get instance jar dir new configuration executor configuration verify detach application runner new 
jar submission i t case before class public static void check o s assume assume false this test fail on window due to unclosed jar file see flink operating system be window 
rock d b operation util test before class public static void load rock library throw exception native library loader get instance load library tmp dir new folder get absolute path 
rock d b resource container test before class public static void ensure rock db native library load throw i o exception native library loader get instance load library tmp folder new folder get absolute path 
stream operator wrapper test before class public static void start time service completable future throwable error future new completable future timer service new system processing time service error future complete 
local executor i t case before class public static void setup throw i o exception cluster client mini cluster resource get cluster client file udf jar test user class loader jar create jar file temp folder new folder test jar test classloader udf jar udf dependency udf jar to u be i to u be l 
generic in memory catalog test before class public static void init catalog new generic in memory catalog test catalog name catalog open 
zoo keeper high availability i t case before class public static void setup throw exception zk server new testing server configuration config new configuration config set integer config constant local number job manager num jm config set integer config constant local number task manager num tms config set integer task manager option num task slot num slot per tm file ha storage root dir temporary folder new folder string cluster id uuid random u u i d to string ha storage dir new file ha storage root dir cluster id config set string high availability option ha storage path ha storage root dir to string config set string high availability option ha cluster id cluster id config set string high availability option ha zookeeper quorum zk server get connect string config set string high availability option ha mode zookeeper config set string config constant metric reporter prefix restart config constant metric reporter class suffix restart reporter class get name we have to manage this manually because we have to create the zoo keeper server ahead of this mini cluster resource new mini cluster with client resource new mini cluster resource configuration builder set configuration config set number task manager num tm set number slot per task manager num slot per tm build mini cluster resource before 
class loader i t case before class public static void set up throw exception configuration config new configuration we need to use the filesystem state backend to ensure flink be not happen again config set string checkpointing option state backend filesystem config set string checkpointing option checkpoint directory folder new folder get absolute file to u be i to string savepoint path config set string checkpointing option savepoint directory folder new folder get absolute file to u be i to string require as we otherwise run out of memory config set task manager option manage memory size memory size parse 80m mini cluster resource new mini cluster resource new mini cluster resource configuration builder set number task manager set number slot per task manager set configuration config build mini cluster resource before 
check forbidden method usage before class public static void init throw exception forbid call add forbid call of string class get method get byte array member as list field parser test class get method test end with delimiter field parser test class get method test delimiter next forbidden call add forbid call of string class get constructor byte class forbid call add forbid call of string class get constructor byte class int class forbid call add forbid call of string class get constructor byte class int class int class forbid call add forbid call of string class get constructor byte class int class int class int class 
job manager h a process failure recovery i t case before class public static void setup zoo keeper new zoo keeper test environment 
file buffer reader i t case before class public static void setup for int i i datum source length i datum source i 
zoo keeper leader election i t case before class public static void setup throw exception zk server new testing server true 
stream operator snapshot restore test before class public static void before class throw i o exception temporary folder new temporary folder temporary folder create 
yarn cluster descriptor test before class public static void setup class yarn configuration new yarn configuration yarn client yarn client create yarn client yarn client init yarn configuration yarn client start 
yarn file stage test before class public static void create h d f s throw exception assume assume true operating system be window final file temp dir class temp dir new folder org apache hadoop conf configuration hd conf new org apache hadoop conf configuration hd conf set mini d f s cluster hdf minidf basedir temp dir get absolute path mini d f s cluster builder builder new mini d f s cluster builder hd conf hdf cluster builder build hdf root path new path hdf cluster get u be i 
yarn file stage test s3 i t case before class public static void check credentials and setup throw i o exception check whether credentials exist s3 test credentials assume credentials available skip test false setup custom hadoop config 
cli frontend run with yarn test before class public static void init cli frontend test util pipe system out to null 
y a r n application i t case before class public static void setup yarn configuration set yarn test base test cluster name key flink yarn test application start y a r n with config yarn configuration true 
y a r n file replication i t case before class public static void setup yarn configuration set yarn test base test cluster name key flink yarn test per job start y a r n with config yarn configuration true 
y a r n high availability i t case before class public static void setup throw exception zk server new testing server storage dir folder new folder get absolute path start y a r n with config should be implement by subclass yarn configuration set class yarn configuration rm scheduler capacity scheduler class resource scheduler class yarn configuration set yarn test base test cluster name key log dir yarn configuration set int yarn configuration nm pmem mb start y a r n with config yarn configuration 
y a r n i t case before class public static void setup yarn configuration set yarn test base test cluster name key flink yarn test per job start y a r n with config yarn configuration true 
yarn priority scheduling i t case before class public static void setup assume true priority scheduling be not support by hadoop version info get version be hadoop version greater than or equal yarn configuration set string yarn cluster max application priority start y a r n with config yarn configuration 
y a r n session capacity scheduler i t case before class public static void setup throw exception yarn configuration set class yarn configuration rm scheduler capacity scheduler class resource scheduler class yarn configuration set yarn scheduler capacity root queue default qa team yarn configuration set int yarn scheduler capacity root default capacity yarn configuration set int yarn scheduler capacity root qa team capacity yarn configuration set yarn test base test cluster name key flink yarn test capacityscheduler start y a r n with config yarn configuration rest client executor executor new single thread executor rest client new rest client rest client configuration from configuration new configuration rest client executor 
y a r n session f i f o i t case before class public static void setup yarn configuration set class yarn configuration rm scheduler fifo scheduler class resource scheduler class yarn configuration set int yarn configuration nm pmem mb yarn configuration set int yarn configuration rm scheduler minimum allocation mb yarn configuration set yarn test base test cluster name key flink yarn test fifo start y a r n with config yarn configuration 
y a r n session f i f o secure i t case before class public static void setup log info start secure cluster environment for testing yarn configuration set class yarn configuration rm scheduler fifo scheduler class resource scheduler class yarn configuration set int yarn configuration nm pmem mb yarn configuration set int yarn configuration rm scheduler minimum allocation mb yarn configuration set yarn test base test cluster name key flink yarn test fifo secure secure test environment prepare tmp populate yarn secure configuration yarn configuration secure test environment get hadoop service principal secure test environment get test keytab configuration flink config new configuration flink config set string security option kerberos login keytab secure test environment get test keytab flink config set string security option kerberos login principal secure test environment get hadoop service principal set customize security module class test hadoop module factory hadoop configuration yarn configuration flink config set security option security module factory class collection singleton list org apache flink yarn util test hadoop module factory flink config set security option security context factory class collection singleton list org apache flink yarn util test hadoop security context factory security configuration security config new security configuration flink config try test security context install security config secure test environment get client security configuration map this be need to ensure that security util be run within a ugi do as section since we already log in here in before class even a no op security context will still work assert assert true hadoop security context must be install security util get install context instanceof hadoop security context security util get install context run secure new callable object override public integer call start y a r n secure mode yarn configuration secure test environment get hadoop service principal secure test environment get test keytab return null catch exception e throw new runtime exception exception occur while set up secure test context reason e 
yarn test base before class public static void setup throw exception start y a r n with config yarn configuration false 
