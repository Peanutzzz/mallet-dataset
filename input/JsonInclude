instance json include include non null public class instance unique id of this instance private string instance id instance ip private string ip instance port private int port instance weight private double weight 1.0 d instance health status private boolean healthy true if instance be enable to accept request private boolean enable true if instance be ephemeral since 1.0 private boolean ephemeral true cluster information of instance private string cluster name service information of instance private string service name user extend attribute private map string string metadata new hash map string string public string get instance id return this instance id public void set instance id final string instance id this instance id instance id public string get ip return this ip public void set ip final string ip this ip ip public int get port return this port public void set port final int port this port port public double get weight return this weight public void set weight final double weight this weight weight public boolean be healthy return this healthy public void set healthy final boolean healthy this healthy healthy public string get cluster name return this cluster name public void set cluster name final string cluster name this cluster name cluster name public string get service name return this service name public void set service name final string service name this service name service name public map string string get metadata return this metadata public void set metadata final map string string metadata this metadata metadata add meta datum param key meta datum key param value meta datum value public void add metadata final string key final string value if metadata null metadata new hash map string string metadata put key value public boolean be enable return this enable public void set enable final boolean enable this enable enable public boolean be ephemeral return this ephemeral public void set ephemeral final boolean ephemeral this ephemeral ephemeral override public string to string return instance instance id instance id ip ip port port weight weight healthy healthy enable enable ephemeral ephemeral cluster name cluster name service name service name metadata metadata public string to inet addr return ip port override public boolean equal final object obj if obj instanceof instance return false final instance host instance obj return instance str equal host to string to string override public int hash code return to string hash code private static boolean str equal final string str1 final string str2 return str1 null str2 null str1 equal str2 public long get instance heart beat interval return get meta datum by key with default preserve metadata key heart beat interval constant default heart beat interval public long get instance heart beat time out return get meta datum by key with default preserve metadata key heart beat timeout constant default heart beat timeout public long get ip delete timeout return get meta datum by key with default preserve metadata key ip delete timeout constant default ip delete timeout public string get instance id generator return get meta datum by key with default preserve metadata key instance id generator constant default instance id generator private long get meta datum by key with default final string key final long default value if get metadata null get metadata be empty return default value final string value get metadatum get key if string util be empty value value match number pattern return long parse long value return default value private string get meta datum by key with default final string key final string default value if get metadata null get metadata be empty return default value return get metadata get key 
service info json include include non null public class service info json ignore private string json from server empty public static final string spliter private string name private string group name private string cluster private long cache millis l private list instance host new array list instance private long last ref time 0 l private string checksum private volatile boolean all i ps false public service info public boolean be all i ps return all i ps public void set all i ps boolean all i ps this all i ps all i ps public service info string key int max index int cluster index int service name index string key key split constant service info spliter if key length max index this name key service name index this cluster key cluster index this name key public service info string name string cluster this name name this cluster cluster public int ip count return host size public boolean expire return system current time millis last ref time cache milli public void set host list instance host this host host public boolean be valid return host null public string get name return name public void set name string name this name name public string get group name return group name public void set group name string group name this group name group name public void set last ref time long last ref time this last ref time last ref time public long get last ref time return last ref time public string get cluster return cluster public void set cluster string cluster this cluster cluster public long get cache millis return cache milli public void set cache milli long cache milli this cache millis cache milli public list instance get host return new array list instance host judge whether service info be validate return true if validate otherwise false public boolean validate if be all i ps return true list instance valid host new array list instance for instance host host if host be healthy continue for int i i host get weight i valid host add host return true json ignore public string get json from server return json from server public void set json from server string json from server this json from server json from server json ignore public string get key return get key name cluster json ignore public static string get key string name string cluster if be empty cluster return name constant service info spliter cluster return name json ignore public string get key encode try return get key u be l encoder encode name utf cluster catch unsupported encode exception e return get key get link service info from key param key key of service info return new service info public static service info from key string key service info service info new service info int max seg count string seg key split constant service info spliter if seg length max seg count service info set group name seg service info set name seg else if seg length max seg count service info set group name seg service info set name seg service info set cluster seg return service info override public string to string return get key public string get checksum return checksum public void set checksum string checksum this checksum checksum private static boolean be empty string str return str null str length private static boolean be empty collection coll return coll null coll be empty private static boolean str equal string str1 string str2 return str1 null str2 null str1 equal str2 private static final string empty private static final string all ip all ip 
instance json include include non null public class instance extend com alibaba naco api name pojo instance implement comparable private static final double max weight value 10000.0 d private static final double min positive weight value 0.01 d private static final double min weight value 0.00 d private volatile long last beat system current time millis json ignore private volatile boolean mock valid false private volatile boolean marked false private string tenant private string app private static final pattern ip pattern pattern compile d 1,3 d 1,3 d 1,3 d 1,3 d 1,5 private static final pattern only digit and dot pattern compile d private static final string spliter public instance public boolean be mock valid return mock valid public void set mock valid boolean mock valid this mock valid mock valid public long get last beat return last beat public void set last beat long last beat this last beat last beat public instance string ip int port this set ip ip this set port port this set cluster name util and common default cluster name public instance string ip int port string cluster name this set ip ip trim this set port port this set cluster name cluster name public instance string ip int port string cluster name string tenant string app this set ip ip trim this set port port this set cluster name cluster name this tenant tenant this app app create link instance from encode string param config instance encode string return new instance public static instance from string string config string ip address attribute config split spliter if ip address attribute length return null string provider ip address attribute matcher matcher ip pattern matcher provider if matcher match return null int expect group count int port if number util be number matcher group expect group count port integer parse int matcher group expect group count instance instance new instance matcher group port possible format of config ip port ip port weight ip port weight cluster ip port weight valid ip port weight valid cluster ip port weight valid marked ip port weight valid marked cluster int minimum length if ip address attribute length minimum length determine weight instance set weight number util to double ip address attribute minimum length minimum length if ip address attribute length minimum length determine valid if boolean true to string equal ip address attribute minimum length boolean false to string equal ip address attribute minimum length instance set healthy boolean parse boolean ip address attribute minimum length determine cluster if boolean true to string equal ip address attribute ip address attribute length boolean false to string equal ip address attribute ip address attribute length instance set cluster name ip address attribute ip address attribute length minimum length if ip address attribute length minimum length determine marked if boolean true to string equal ip address attribute minimum length boolean false to string equal ip address attribute minimum length instance set marked boolean parse boolean ip address attribute minimum length return instance public string to ip addr return get ip get port override public string to string return get datum key spliter get weight spliter be healthy spliter marked spliter get cluster name serialize to json return json string public string to json return jackson util to json this create link instance from json string param json json string return new instance public static instance from json string json instance ip try ip jackson util to obj json instance class catch exception e ip from string json if ip null throw new illegal argument exception malformed ip config json if ip get weight max weight value ip set weight max weight value if ip get weight min positive weight value ip get weight min weight value ip set weight min positive weight value else if ip get weight min weight value ip set weight 0.0 d try ip validate catch naco exception e throw new illegal argument exception malformed ip config json return ip override public boolean equal object obj if null obj obj get class get class return false if obj this return true instance other instance obj mean wild return get ip equal other get ip get port other get port get port this be ephemeral other be ephemeral json ignore public string get datum key if get port return get ip get port util and common localhost site get cluster name else return get ip util and common localhost site get cluster name json ignore public string get default key if get port return get ip get port util and common unknown site else return get ip util and common unknown site override public int hash code return get ip hash code public void set be check boolean be be check health check status get this be be check set be be check public boolean mark check return health check status get this be be check compare and set false true json ignore public long get check rt return health check status get this check rt json ignore public atomic integer get ok count return health check status get this check ok count json ignore public atomic integer get fail count return health check status get this check fail count json ignore public void set check rt long check rt health check status get this check rt check rt public boolean be marked return mark public void set marked boolean mark this marked marked public string get app return app public void set app string app this app app public string get tenant return tenant public void set tenant string tenant this tenant tenant public string generate instance id return get ip get port get cluster name get service name generate instance id param current instance id current instance id return new instance id public string generate instance id set string current instance id string instance id generator get instance id generator if constant snowflake instance id generator equal ignore case instance id generator return generate snowflake instance id current instance id else return generate instance id private string generate snowflake instance id set string current instance id int id while current instance id contain string value of id id string id str string value of id current instance id add id str return id str judge whether this instance be validate throw naco exception if instance be not validate public void validate throw naco exception if only contain digit and dot matcher matcher ip pattern matcher get ip get port if matcher match throw new naco exception naco exception invalid param instance format invalid you ip address be spell incorrectly if get weight max weight value get weight min weight value throw new naco exception naco exception invalid param instance format invalid the weight range from min weight value to max weight value private boolean only contain digit and dot matcher matcher only digit and dot matcher get ip return matcher match override public int compare to object o if o instanceof instance logger srv log error instance compare object be not a instance of i p adress object o get class throw new illegal argument exception object be not a instance of i p adress object o get class instance instance instance o string ip key instance to string return this to string compare to ip key 
service json include include non null public class service extend com alibaba naco api name pojo service implement record record listener instance private static final string service name syntax 0 - 9 a z a z json ignore private client beat check task client beat check task new client beat check task this identify the information use to determine how many be empty judgment the service have experience private int finalize count private string token private list string owner new array list private boolean reset weight false private boolean enable true private selector selector new none selector private string namespace id ip will be delete if it have not send beat for some time default timeout be seconds private long ip delete timeout private volatile long last modify millis 0 l private volatile string checksum todo set customize push expire time private long push cache millis 0 l private map string cluster cluster map new hash map public service public service string name super name json ignore public push service get push service return application util get bean push service class public long get ip delete timeout return ip delete timeout public void set ip delete timeout long ip delete timeout this ip delete timeout ip delete timeout process client beat param rs info metric info of server public void process client beat final rs info rs info client beat processor client beat processor new client beat processor client beat processor set service this client beat processor set rs info rs info health check reactor schedule now client beat processor public boolean get enable return enable public void set enable boolean enable this enable enable public long get last modify millis return last modify millis public void set last modify millis long last modify millis this last modify millis last modify millis public boolean get reset weight return reset weight public void set reset weight boolean reset weight this reset weight reset weight public selector get selector return selector public void set selector selector selector this selector selector override public boolean interest string key return key builder match instance list key key namespace id get name override public boolean match unlisten key string key return key builder match instance list key key namespace id get name override public void on change string key instance value throw exception logger srv log info naco raft datum be change key value key value for instance instance value get instance list if instance null reject this abnormal instance list throw new runtime exception get null instance key if instance get weight 10000.0 d instance set weight 10000.0 d if instance get weight 0.01 d instance get weight 0.0 d instance set weight 0.01 d update i ps value get instance list key builder match ephemeral instance list key key recalculate checksum override public void on delete string key throw exception ignore get count of healthy instance in service return count of healthy instance public int healthy instance count int healthy count for instance instance all i ps if instance be healthy healthy count return healthy count public boolean trigger flag return healthy instance count 1.0 all i ps size get protect threshold update instance param instance instance param ephemeral whether be ephemeral instance public void update i ps collection instance instance boolean ephemeral map string list instance ip map new hash map cluster map size for string cluster name cluster map key set ip map put cluster name new array list for instance instance instance try if instance null logger srv log error naco dom receive malformed ip null continue if string util be empty instance get cluster name instance set cluster name util and common default cluster name if cluster map contain key instance get cluster name logger srv log warn cluster not find ip will create new cluster with default configuration instance get cluster name instance to json cluster cluster new cluster instance get cluster name this cluster init get cluster map put instance get cluster name cluster list instance cluster i ps ip map get instance get cluster name if cluster i ps null cluster i ps new link list ip map put instance get cluster name cluster i ps cluster i ps add instance catch exception e logger srv log error naco dom fail to process ip instance e for map entry string list instance entry ip map entry set make every ip mine list instance entry i ps entry get value cluster map get entry get key update ip entry i ps ephemeral set last modify millis system current time milli get push service service change this string builder string builder new string builder for instance instance all i ps string builder append instance to ip addr append append instance be healthy append logger evt log info ip update namespace service ip get namespace id get name string builder to string init service public void init health check reactor schedule check client beat check task for map entry string cluster entry cluster map entry set entry get value set service this entry get value init destroy service throw exception exception public void destroy throw exception for map entry string cluster entry cluster map entry set entry get value destroy health check reactor cancel check client beat check task judge whether service have instance return true if no instance otherwise false public boolean be empty for map entry string cluster entry cluster map entry set final cluster cluster entry get value if cluster be empty return false return true get all instance return list of all instance public list instance all i ps list instance result new array list for map entry string cluster entry cluster map entry set result add all entry get value all i ps return result get all instance of ephemeral or consistency param ephemeral whether ephemeral instance return all instance of ephemeral if param ephemeral true otherwise all instance of consistency public list instance all i ps boolean ephemeral list instance result new array list for map entry string cluster entry cluster map entry set result add all entry get value all i ps ephemeral return result get all instance from input cluster param cluster cluster name return all instance from input cluster public list instance all i ps list string cluster list instance result new array list for string cluster cluster cluster cluster obj cluster map get cluster if cluster obj null continue result add all cluster obj all i ps return result get all instance from input cluster param cluster cluster name return all instance from input cluster if cluster be empty return all cluster public list instance srv i ps list string cluster if collection util be empty cluster cluster new array list cluster add all cluster map key set return all i ps cluster public string to json return jackson util to json this json ignore public string get service string map object object service object new hash map object object service service this service object put name service get name list instance ip service all i ps int invalid ip count int ip count for instance ip ip if ip be healthy invalid ip count ip count service object put ip count ip count service object put invalid i p count invalid ip count service object put owner service get owner service object put token service get token service object put protect threshold service get protect threshold list object cluster list new array list object for map entry string cluster entry service get cluster map entry set cluster cluster entry get value map object object cluster new hash map object object cluster put name cluster get name cluster put health checker cluster get health checker cluster put def ckport cluster get def ckport cluster put def i p port cluster get def i p port cluster put use i p port4 check cluster be use i p port4 check cluster put sitegroup cluster get sitegroup cluster list add cluster service object put cluster cluster list try return jackson util to json service object catch exception e throw new runtime exception service to json fail e public string get token return token public void set token string token this token token public list string get owner return owner public void set owner list string owner this owner owner public map string cluster get cluster map return cluster map public void set cluster map map string cluster cluster map this cluster map cluster map public string get namespace id return namespace id public void set namespace id string namespace id this namespace id namespace id update from other service param v dom other service public void update service v dom if string util equal token v dom get token logger srv log info service update service token get name token v dom get token token v dom get token if list util be equal list owner v dom get owner logger srv log info service update service owner get name owner v dom get owner owner v dom get owner if get protect threshold v dom get protect threshold logger srv log info service update service protect threshold get name get protect threshold v dom get protect threshold set protect threshold v dom get protect threshold if reset weight v dom get reset weight boolean value logger srv log info service update service reset weight get name reset weight v dom get reset weight reset weight v dom get reset weight if enable v dom get enable boolean value logger srv log info service update service enable get name enable v dom get enable enable v dom get enable selector v dom get selector set metadata v dom get metadata update or add cluster v dom get cluster map value remv dead cluster this v dom logger srv log info cluster size new old get cluster map size v dom get cluster map size recalculate checksum override public string get checksum if string util be empty checksum recalculate checksum return checksum re calculate checksum of service public synchronize void recalculate checksum list instance ip all i ps string builder ip string new string builder ip string append get service string if logger srv log be debug enable logger srv log debug service to json get service string if collection util be not empty ips collection sort ips for instance ip ip string string ip get ip ip get port ip get weight ip be healthy ip get cluster name ip string append string ips string append checksum m d5 util md5 hex ip string to string constant encode private void update or add cluster collection cluster cluster for cluster cluster cluster cluster old cluster cluster map get cluster get name if old cluster null old cluster set service this old cluster update cluster else cluster init cluster set service this cluster map put cluster get name cluster private void remv dead cluster service old dom service new dom collection cluster old cluster old dom get cluster map value collection cluster new cluster new dom get cluster map value list cluster dead cluster list cluster collection util subtract old cluster new cluster for cluster cluster dead cluster old dom get cluster map remove cluster get name cluster destroy public int get finalize count return finalize count public void set finalize count int finalize count this finalize count finalize count public void add cluster cluster cluster cluster map put cluster get name cluster judge whether service be validate throw illegal argument exception if service be not validate public void validate if get name match service name syntax throw new illegal argument exception dom name can only have these character 0 - 9 a z a z current get name for cluster cluster cluster map value cluster validate 
d metric json include json include include non null public abstract class d metric name of metric type tag field and they getter must not be change since they be map to json object in a datadog define format private final string metric metric name private final metric type type private final string host private final list string tag private final clock clock public d metric metric type metric type string metric string host list string tag clock clock this type metric type this metric metric this host host this tag tag this clock clock public metric type get type return type public string get metric return metric public string get host return host public list string get tag return tag public list list number get point one single datum point list number point new array list point add clock get unix epoch timestamp point add get metric value list list number point new array list point add point return point json ignore public abstract number get metric value public void ack report 
asynchronous operation info json include json include include non null public class asynchronous operation info private static final string field name failure cause failure cause json property field name failure cause json serialize use serialize throwable serializer class nullable private final serialize throwable failure cause private asynchronous operation info json property field name failure cause json deserialize use serialize throwable deserializer class nullable serialized throwable failure cause this failure cause failure cause nullable public serialize throwable get failure cause return failure cause public static asynchronous operation info complete exceptional serialize throwable serialize throwable return new asynchronous operation info serialize throwable public static asynchronous operation info complete return new asynchronous operation info null 
job execution result response body json include json include include non null public class job execution result response body implement response body asynchronously create resource job result json property value status require true private final queue status status json property value job execution result json serialize use job result serializer class json deserialize use job result deserializer class nullable private final job result job execution result json creator public job execution result response body json property value status require true final queue status status json property value job execution result json deserialize use job result deserializer class nullable final job result job execution result this status require non null status this job execution result job execution result public static job execution result response body in progress return new job execution result response body queue status in progress null public static job execution result response body create final job result job execution result return new job execution result response body queue status complete job execution result public queue status get status return status nullable public job result get job execution result return job execution result override public queue status queue status return status override public job result resource return job execution result 
aggregate metric json include json include include non null json property field name min private final double min 
aggregate metric json include json include include non null json property field name max private final double max 
aggregate metric json include json include include non null json property field name avg private final double avg 
aggregate metric json include json include include non null json property field name sum private final double sum 
metric json include json include include non null json property value field name value private final string value 
savepoint info json include json include include non null public class savepoint info implement response body private static final string field name location location private static final string field name failure cause failure cause json property field name location nullable private final string location json property field name failure cause json serialize use serialize throwable serializer class json deserialize use serialize throwable deserializer class nullable private final serialize throwable failure cause json creator public savepoint info json property field name location nullable final string location json property field name failure cause json deserialize use serialize throwable deserializer class nullable final serialize throwable failure cause check argument location null failure cause null either location or failure cause must be set this location location this failure cause failure cause nullable public string get location return location nullable public serialize throwable get failure cause return failure cause 
job vertex back pressure info json include json include include non null public class job vertex back pressure info implement response body public static final string field name status status public static final string field name backpressure level backpressure level public static final string field name end timestamp end timestamp public static final string field name subtask subtask immutable singleton instance denote that the back pressure stats be not available private static final job vertex back pressure info deprecate job vertex back pressure info new job vertex back pressure info vertex back pressure status deprecate null null null json property field name status private final vertex back pressure status status json property field name backpressure level private final vertex back pressure level backpressure level json property field name end timestamp private final long end timestamp json property field name subtask private final list subtask back pressure info subtask json creator public job vertex back pressure info json property field name status vertex back pressure status status json property field name backpressure level vertex back pressure level backpressure level json property field name end timestamp long end timestamp json property field name subtask list subtask back pressure info subtask this status status this backpressure level backpressure level this end timestamp end timestamp this subtask subtask public static job vertex back pressure info deprecate return deprecate job vertex back pressure info override public boolean equal object o if this o return true if o null get class o get class return false job vertex back pressure info that job vertex back pressure info o return object equal status that status object equal backpressure level that backpressure level object equal end timestamp that end timestamp object equal subtask that subtask override public int hash code return object hash status backpressure level end timestamp subtask public vertex back pressure status get status return status nullable public vertex back pressure level get backpressure level return backpressure level nullable public long get end timestamp return end timestamp nullable public list subtask back pressure info get subtask return subtasks null null collection unmodifiable list subtask static helper class nest class to encapsulate the sub task back pressure public static final class subtask back pressure info public static final string field name subtask subtask public static final string field name backpressure level backpressure level public static final string field name ratio ratio json property field name subtask private final int subtask json property field name backpressure level private final vertex back pressure level backpressure level json property field name ratio private final double ratio public subtask back pressure info json property field name subtask int subtask json property field name backpressure level vertex back pressure level backpressure level json property field name ratio double ratio this subtask subtask this backpressure level check not null backpressure level this ratio ratio override public boolean equal object o if this o return true if o null get class o get class return false subtask back pressure info that subtask back pressure info o return subtask that subtask ratio that ratio object equal backpressure level that backpressure level override public int hash code return object hash subtask backpressure level ratio public int get subtask return subtask public vertex back pressure level get backpressure level return backpressure level public double get ratio return ratio status of vertex back pressure public enum vertex back pressure status deprecate deprecate ok ok private string status vertex back pressure status string status this status status json value override public string to string return status level of vertex back pressure public enum vertex back pressure level ok ok low low high high private string level vertex back pressure level string level this level level json value override public string to string return level 
jar plan request body json include json include include non null public class jar plan request body extend jar request body jar plan request body super null null null null null json creator jar plan request body nullable json property field name entry class string entry class name nullable json property field name program argument string program argument nullable json property field name program argument list list string program argument list nullable json property field name parallelism integer parallelism nullable json property field name job id job i d job id super entry class name program argument program argument list parallelism job id 
jar request body json include json include include non null public abstract class jar request body implement request body static final string field name entry class entry class static final string field name program argument program arg static final string field name program argument list program arg list static final string field name parallelism parallelism static final string field name job id job id json property field name entry class nullable private string entry class name json property field name program argument nullable private string program argument json property field name program argument list nullable private list string program argument list json property field name parallelism nullable private integer parallelism json property field name job id json deserialize use job i d deserializer class json serialize use job i d serializer class nullable private job i d job id jar request body this null null null null null json creator jar request body nullable json property field name entry class string entry class name nullable json property field name program argument string program argument nullable json property field name program argument list list string program argument list nullable json property field name parallelism integer parallelism nullable json property field name job id job i d job id this entry class name entry class name this program argument program argument this program argument list program argument list this parallelism parallelism this job id job id nullable json ignore public string get entry class name return entry class name nullable json ignore public string get program argument return program argument nullable json ignore public list string get program argument list return program argument list nullable json ignore public integer get parallelism return parallelism nullable json ignore public job i would get job id return job id 
jar run request body json include json include include non null public class jar run request body extend jar request body private static final string field name allow non restore state allow non restore state private static final string field name savepoint path savepoint path json property field name allow non restore state nullable private boolean allow non restore state json property field name savepoint path nullable private string savepoint path public jar run request body this null null null null null null null json creator public jar run request body nullable json property field name entry class string entry class name nullable json property field name program argument string program argument nullable json property field name program argument list list string program argument list nullable json property field name parallelism integer parallelism nullable json property field name job id job i d job id nullable json property field name allow non restore state boolean allow non restore state nullable json property field name savepoint path string savepoint path super entry class name program argument program argument list parallelism job id this allow non restore state allow non restore state this savepoint path savepoint path nullable json ignore public boolean get allow non restore state return allow non restore state nullable json ignore public string get savepoint path return savepoint path 
