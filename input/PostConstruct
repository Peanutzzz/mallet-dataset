db audit service impl post construct public void init string sql create table if not exist sys logger n id int not null auto increment n application name varchar character set utf8 collate utf8 general ci null comment n class name varchar character set utf8 collate utf8 general ci not null comment n method name varchar character set utf8 collate utf8 general ci not null comment n user id int null comment id n user name varchar character set utf8 collate utf8 general ci null comment n client id varchar character set utf8 collate utf8 general ci null comment id n operation varchar character set utf8 collate utf8 general ci not null comment n timestamp varchar character set utf8 collate utf8 general ci not null comment n primary key id use btree n engine inno d b character set utf8 collate utf8 general ci row format dynamic this jdbc template execute sql 
feign http interceptor config post construct public void initialize request header add security constant user id header request header add security constant user header request header add security constant role header request header add common constant z l t version 
abstract controller test post construct private void post construct rest template set error handler new default response error handler rest template set message converter http message converter get converter 
database message sender post construct private void initialize clean executor service submit while clean stop get thread current thread be interrupted try long rm to clean poll time unit seconds if rm null clean message rm else time unit seconds sleep catch throwable ex tracer log error ex 
refreshable config post construct public void setup property source get refreshable property source if collection util be empty property source throw new illegal state exception property source can not be empty add property source to environment for refreshable property source property source property source property source refresh environment get property source add last property source task to update config schedule executor service executor service executor new schedule thread pool apollo thread factory create config refresher true executor service schedule with fix delay try property source for each refreshable property source refresh catch throwable t logger error refresh config fail t tracer log error refresh config fail t config refresh interval config refresh interval time unit seconds 
config service with cache post construct void initialize config cache cache builder new builder expire after access default expire after access in minute time unit minute build new cache loader string config cache entry override public config cache entry load string key throw exception list string namespace info string splitter split to list key if namespace info size tracer log error new illegal argument exception string format invalid cache load key s key return null config cache entry transaction transaction tracer new transaction tracer event cache load key try release message latest release message release message service find latest release message for message list new array list key release latest release release service find latest active release namespace info get namespace info get namespace info get transaction set status transaction success long notification id latest release message null config const notification id placeholder latest release message get id if notification id config const notification id placeholder latest release null return null config cache entry return new config cache entry notification id latest release catch throwable ex transaction set status ex throw ex finally transaction complete config id cache cache builder new builder expire after access default expire after access in minute time unit minute build new cache loader long optional release override public optional release load long key throw exception transaction transaction tracer new transaction tracer event cache load id string value of key try release release release service find active one key transaction set status transaction success return optional of nullable release catch throwable ex transaction set status ex throw ex finally transaction complete 
abstract base integration test post construct private void post construct rest template set error handler new default response error handler 
sample redis config post construct private void initialize logger info sample redis config initialize expire seconds cluster node command timeout some map some list expire seconds cluster node command timeout some map some list 
admin service address locator post construct public void init all env portal setting get all env init rest template rest template rest template factory get object refresh service address service executor new schedule thread pool apollo thread factory create service locator true refresh service address service schedule new refresh admin server address task time unit millisecond 
portal setting post construct private void post construct all env portal config portal support env for env env all env env status mark put env true schedule executor service health check service executor new schedule thread pool apollo thread factory create env health checker true health check service schedule with fix delay new health check task application context health check interval time unit millisecond 
retryable rest template post construct private void post construct rest template rest template factory get object 
system info controller post construct private void init rest template rest template factory get object 
config publish listener post construct public void init executor service executor new single thread executor apollo thread factory create config publish notify true 
system role manager service post construct private void init role initialization service init create app role 
ctrip email request builder post construct public void init try send email request clazz class for name com ctrip framework apolloctripservice emailservice send email request set send code send email request clazz get method set send code string class set body template i would send email request clazz get method set body template i d integer class set sender send email request clazz get method set sender string class set body content send email request clazz get method set body content string class set recipient send email request clazz get method set recipient list class set subject send email request clazz get method set subject string class set be body html send email request clazz get method set be body html boolean class set charset send email request clazz get method set charset string class set expire time send email request clazz get method set expire time calendar class set app i would send email request clazz get method set app i d integer class catch throwable e logger error init email request build fail e tracer log error init email request build fail e 
ctrip email service post construct public void init try init service client config class email service client clazz class for name com ctrip framework apolloctripservice emailservice email service client method get instance method email service client clazz get method get instance email service client get instance method invoke null class send email request clazz class for name com ctrip framework apolloctripservice emailservice send email request send email async email service client clazz get method send email async send email request clazz send email email service client clazz get method send email send email request clazz catch throwable e logger error init ctrip email service fail e tracer log error init ctrip email service fail e 
ctrip m q service post construct public void init rest template new rest template simple client http request factory rf simple client http request factory rest template get request factory rf set read timeout portal config read timeout rf set connect timeout portal config connect timeout mapping jackson2 http message converter converter new mapping jackson2 http message converter converter set support media type array as list media type application json u t f8 media type application octet stream rest template set message converter array as list converter new form http message converter 
spring security user service post construct public void init authority new array list authority add new simple grant authority role user 
cmdb provider post construct public void init throw naco exception init cmdb service load cmdb executor schedule cmdb task new cmdb dump task switch get dump task interval time unit seconds cmdb executor schedule cmdb task new cmdb label task switch get label task interval time unit seconds cmdb executor schedule cmdb task new cmdb event task switch get event task interval time unit seconds 
external permission persist service impl post construct protect void init jt persist service get jdbc template 
external role persist service impl post construct protect void init jt persist service get jdbc template 
external user persist service impl post construct protect void init jt persist service get jdbc template 
health controller post construct public void init datum source service dynamic datum source get instance get datum source 
curcuit filter post construct protect void init listener self in cluster register subscribe 
capacity service post construct suppress warning pmd thread pool creation rule public void init all server have job that modify usage idempotent config executor schedule correct usage task new runnable override public void run logger info capacity management start correct usage stopwatch stopwatch stopwatch create start correct usage logger info capacity management end correct usage cost s stopwatch elapse time unit seconds property util get correct usage delay property util get correct usage delay time unit seconds 
group capacity persist service post construct public void init this data source service dynamic datum source get instance get datum source this jdbc template datum source service get jdbc template 
tenant capacity persist service post construct public void init this data source service dynamic datum source get instance get datum source this jdbc template datum source service get jdbc template 
local datum source service impl post construct override public synchronize void init throw exception if property util be use external d b if initialize log util default log info use local db service for init final string jdbc url jdbc derby path get application util get naco home derby base dir to string create true initialize jdbc url initialize true 
embed dump service post construct override protect void init throw throwable if application util get standalone mode dump operate processor dump all processor dump all beta processor dump all tag processor return c p protocol protocol protocol manager get cp protocol atomic reference throwable error reference new atomic reference null count down latch wait dump finish new count down latch watch path naco config leader have value observer observer new observer override public void update observable o object arg global executor execute by common must make sure that there be a value here to perform the correct operation that follow if object be null arg return identify without a timeout mechanism embed storage context util put extend info constant extend need read until have datum true remove you own listening to avoid task accumulation boolean can end false for try dump operate processor dump all processor dump all beta processor dump all tag processor protocol protocol meta datum un subscribe constant config model raft group metadata key leader meta datum this can end true catch throwable ex if should retry ex error reference set ex can end true if can end thread util count down wait dump finish break thread util sleep l embed storage context util clean all context protocol protocol meta datum subscribe constant config model raft group metadata key leader meta datum observer we must wait for the dump task to complete the callback operation before continue with the initialization thread util latch await wait dump finish if a exception occur during the execution of the dump task the exception need to be throw trigger the node to start the failed process final throwable ex error reference get if object non null ex throw ex 
external dump service post construct override protect void init throw throwable dump operate processor dump all processor dump all beta processor dump all tag processor 
embed storage persist service impl post construct public void init datum source service dynamic datum source get instance get datum source id generator manager register resource config info id resource config history id resource config tag relation id resource app configdata relation sub resource config beta id resource namespace id resource user id resource role id resource permission id 
standalone database operate impl post construct protect void init datum source service datum source service dynamic datum source get instance get datum source jdbc template datum source service get jdbc template transaction template datum source service get transaction template log util default log info use standalone database operate impl 
external storage persist service impl post construct public void init datum source service dynamic datum source get instance get datum source jt get jdbc template tjt get transaction template 
console config post construct public void init method cache init class method com alibaba naco name controller method cache init class method com alibaba naco console controller method cache init class method com alibaba naco config server controller 
jwt token util post construct public void init use default secret key for sha if custom secret key str null default secret flag equal custom secret key str this secret key key secret key for signature algorithm h s256 else use custom secret key int size custom secret key str length int left sha secret char size size if leave character for padding string builder string builder new string builder custom secret key str for int i i leave i string builder append i this secret key key hmac sha key for string builder to string get byte else this secret key key hmac sha key for custom secret key str get byte this token validity in millisecond 30 l 
protocol manager post construct public void init this member manager member manager notify center register subscriber this 
naco mcp server post construct public void start throw i o exception if istio config be mcp server enable return logger main info mcp server start naco mcp server server server builder for port port add service server interceptor intercept naco mcp service intercepter build server start runtime get runtime add shutdown hook new thread override public void run system out println stop naco mcp server naco mcp server this stop system out println naco mcp server stop 
naco mcp service post construct public void init if istio config be mcp server enable return global executor schedule mcp push task new mcp push task mcp push period millisecond mcp push period millisecond 
server list manager post construct public void init global executor register server status reporter new server status reporter global executor register server info updater new server info updater 
server status manager post construct public void init global executor register server status updater new server status updater 
datum syncer post construct public void init start time sync 
distro consistency service impl post construct public void init global executor submit load datum task load datum task global executor submit distro notify task notifier 
task dispatcher post construct public void init for int i i cpu core count i task scheduler task scheduler new task scheduler i task scheduler list add task scheduler global executor submit task dispatch task scheduler 
raft core post construct public void init throw exception logger raft info initialize raft sub system executor submit notifier final long start system current time millis raft store load datum notifier datum set term number util to long raft store load meta get property term 0 l logger raft info cache load datum count current term datum size peer get term while true if notifier task size break thread sleep l initialize true logger raft info finish to load datum from disk cost ms system current time millis start global executor register master election new master election global executor register heartbeat new heart beat logger raft info timer start leader timeout ms heart beat timeout ms global executor leader timeout ms global executor heartbeat interval ms 
raft peer set post construct public void init notify center register subscriber this change peer member manager all member 
distro mapper post construct public void init notify center register subscriber this this healthy list member util simple member member manager all member 
service manager post construct public void init global executor schedule service reporter new service reporter time unit millisecond global executor submit service update manager new updated service processor if empty service auto clean logger srv log info open empty service auto clean job initial delay ms period ms clean empty service delay clean empty service period delay 60 period 20 this task be not recommend to be perform frequently in order to avoid the possibility that the service cache information may just be delete and then create due to the heartbeat mechanism global executor schedule service auto clean new empty service auto clean clean empty service delay clean empty service period try logger srv log info listen for service meta change consistency service listen key builder service meta key prefix this catch nacos exception e logger srv log error listen for service meta change fail 
switch manager post construct public void init try consistency service listen key builder get switch domain key this catch nacos exception e logger srv log error listen switch service fail e 
performance logger thread post construct public void init start 
web config post construct public void do init set string suffix set new hash set array as list j css html ico txt woff woff2 example register a url cleaner to exclude u be l of common static resource web callback manager set url cleaner url if string util be empty url return url if suffix set stream any match url end with return null return url 
app management post construct public void init machine discovery context get bean simple machine discovery class 
gateway configuration post construct public void do init init customize apis init gateway rule 
gateway rule config post construct public void do init prepare some gateway rule and api definition only for demo it be recommend to leverage dynamic datum source or the sentinel dashboard to push the rule init customize apis init gateway rule 
filter register service post construct public void initialize for zuul filter filter filter this filter registry put filter filter name filter 
