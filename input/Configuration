aliyun o s s auto configure configuration conditional on property name zlt file server type have value aliyun public class aliyun o s s auto configure autowire private file server property file property client aliyun oss access key bean public o s s client oss client o s s client oss client new o s s client file property get oss get endpoint new default credential provider file property get oss get access key file property get oss get access key secret null return oss client service public class aliyun oss service impl extend abstract i file service autowired private o s s client oss client override protect string file type return file property get type override protect void upload file multipart file file file info file info throw exception oss client put object file property get oss get bucket name file info get name file get input stream file info set url file property get oss get domain file info get name override protect boolean delete file file info file info oss client delete object file property get oss get bucket name file info get name return true 
asyc task executor config configuration public class asyc task executor config extend default asyc task config 
fastdf auto configure configuration conditional on property name zlt file server type have value fastdf public class fastdf auto configure autowire private file server property file property service public class fastdf service impl extend abstract i file service autowired private fast file storage client storage client override protect string file type return file property get type override protect void upload file multipart file file file info file info throw exception store path store path storage client upload file file get input stream file get size filename util get extension file get original filename null file info set url http file property get fdf get web url store path get full path file info set path store path get full path override protect boolean delete file file info file info if file info null str util be not empty file info get path store path store path store path parse from url file info get path storage client delete file store path get group store path get path return true 
qiniu o s s auto configure configuration conditional on property name zlt file server type have value qiniu public class qiniu o s s auto configure autowire private file server property file property bean public com qiniu storage configuration qiniu config return new com qiniu storage configuration zone zone2 bean public upload manager upload manager return new upload manager qiniu config return bean public auth auth return auth create file property get oss get access key file property get oss get access key secret bean public bucket manager bucket manager return new bucket manager auth qiniu config service public class qiniu oss service impl extend abstract i file service autowired private upload manager upload manager autowire private bucket manager bucket manager autowire private auth auth override protect string file type return file property get type override protect void upload file multipart file file file info file info throw exception put upload manager put file get byte file info get name auth upload token file property get oss get bucket name file info set url file property get oss get endpoint file info get name file info set path file property get oss get endpoint file info get name override protect boolean delete file file info file info try response response bucket manager delete file property get oss get bucket name file info get path int retry while response need retry retry response bucket manager delete file property get oss get bucket name file info get path catch qiniu exception e return false return true 
web mvc config configuration public class web mvc config extend default web mvc config 
asyc task executor config configuration public class asyc task executor config extend default asyc task config 
web mvc config configuration public class web mvc config extend default web mvc config 
asyc task executor config configuration public class asyc task executor config extend default asyc task config 
password config configuration public class password config extend default password config 
web mvc config configuration public class web mvc config extend default web mvc config 
log auto configure configuration conditional on class hikari config class enable configuration property log db property class public static class log db auto configure 
sentinel auto configure configuration conditional on class http servlet request class public static class webmvc handler bean public block exception handler webmvc block exception handler return request response e response set status result result result fail e get message response get writer print j s o n util to json str result 
sentinel auto configure configuration conditional on class server response class public static class webflux handler bean public block request handler webflux block exception handler return exchange t server response status http status too many request content type media type application json body body inserter from value result fail t get message 
security config enable o auth2 sso configuration public class security config extend web security configurer adapter value security oauth2 sso login path private string login path resource private logout success handler sso logout success handler override public void configure http security http throw exception http authorize request any request authenticate and csrf disable logout logout success handler sso logout success handler if str util be not empty login path http form login login processing url login path 
feign configuration component scan configuration enable feign client public class feign configuration 
cor config configuration public class cor config private static final string all order order highest precedence bean public cor web filter cor filter cor configuration config new cor configuration cookie config set allow credentials boolean true config add allow method all config add allow origin all config add allow header all j config add expose header set token url base cor configuration source source new url base cor configuration source new path pattern parser source register cor configuration config return new cor web filter source 
dynamic route config configuration conditional on property prefix zlt gateway dynamic route name enable have value true public class dynamic route config autowire private application event publisher publisher naco configuration conditional on property prefix zlt gateway dynamic route name datum type have value naco match if missing true public class naco dyn route autowired private naco config property naco config property bean public naco route definition repository naco route definition repository return new naco route definition repository publisher naco config property 
dynamic route config configuration conditional on property prefix zlt gateway dynamic route name datum type have value naco match if missing true public class naco dyn route autowired private naco config property naco config property bean public naco route definition repository naco route definition repository return new naco route definition repository publisher naco config property 
resource server configuration configuration public class resource server configuration autowire private security property security property autowire private token store token store autowire private permission auth manager permission auth manager bean security web filter chain spring security filter chain server http security http reactive authentication manager custom authentication manager new custom authentication manager token store json authentication entry point entry point new json authentication entry point token server bearer token authentication converter token authentication converter new server bearer token authentication converter token authentication converter set allow uri query parameter true oauth2 authentication web filter oauth2 filter new authentication web filter custom authentication manager oauth2 filter set server authentication converter token authentication converter oauth2 filter set authentication failure handler new server authentication entry point failure handler entry point oauth2 filter set authentication success handler new oauth2 auth success handler http add filter at oauth2 filter security web filter order authentication server http security authorize exchange spec authorize exchange http authorize exchange if security property get auth get http url length authorize exchange path matcher security property get auth get http url authenticate if security property get ignore get url length authorize exchange path matcher security property get ignore get url permit all authorize exchange path matcher http method option permit all any exchange access permission auth manager and exception handle access deny handler new json access deny handler authentication entry point entry point and header frame option disable and http basic disable csrf disable return http build 
custom error web flux auto configuration configuration conditional on web application type conditional on web application type reactive conditional on class web flux configurer class auto configure before web flux auto configuration class enable configuration property server property class resource property class public class custom error web flux auto configuration private final server property server property private final application context application context private final resource property resource property private final list view resolver view resolver private final server codec configurer server codec configurer public custom error web flux auto configuration server property server property resource property resource property object provider list view resolver view resolver provider server codec configurer server codec configurer application context application context this server property server property this application context application context this resource property resource property this view resolver view resolver provider get if available collection empty list this server codec configurer server codec configurer bean order order highest precedence public error web exception handler error web exception handler error attribute error attribute json error web exception handler exception handler new json error web exception handler error attribute this resource property this server property get error this application context exception handler set view resolver this view resolver exception handler set message writer this server codec configurer get writer exception handler set message reader this server codec configurer get reader return exception handler 
asyc task executor config configuration public class asyc task executor config extend default asyc task config 
cor configration configuration public class cor configration bean public cor filter cor filter url base cor configuration source source new url base cor configuration source cor configuration config new cor configuration uri config add allow origin cor configuration all cookie config set allow credentials true config add allow header cor configuration all config add allow method cor configuration all source register cor configuration config return new cor filter source bean public filter registration bean some filter registration filter registration bean cor filter registration new filter registration bean registration set filter cor filter registration add url pattern registration set name cor filter registration set order order highest precedence return registration 
dynamic zuul route config configuration conditional on property prefix zlt gateway dynamic route name enable have value true public class dynamic zuul route config autowire private zuul property zuul property autowire private dispatcher servlet path dispatcher servlet path naco configuration conditional on property prefix zlt gateway dynamic route name datum type have value naco match if missing true public class naco zuul route autowired private naco config property naco config property autowire private application event publisher publisher bean public naco dyn route locator naco dyn route locator return new naco dyn route locator naco config property publisher dispatcher servlet path get prefix zuul property 
dynamic zuul route config configuration conditional on property prefix zlt gateway dynamic route name datum type have value naco match if missing true public class naco zuul route autowired private naco config property naco config property autowire private application event publisher publisher bean public naco dyn route locator naco dyn route locator return new naco dyn route locator naco config property publisher dispatcher servlet path get prefix zuul property 
resource server configuration configuration enable resource server import default password config class public class resource server configuration extend default resource server conf override public http security set authenticate expression url authorization configurer http security authorize url authorize url return authorize url access permission service have permission request authentication and 
swagger config configuration enable swagger butler public class swagger config 
web mvc config configuration public class web mvc config extend web mvc configurer adapter resource private permission interceptor permission interceptor resource private cookie interceptor cookie interceptor override public void add interceptor interceptor registry registry registry add interceptor permission interceptor add path pattern registry add interceptor cookie interceptor add path pattern super add interceptor registry 
xxl job admin config configuration public class xxl job admin config implement initialize bean private static xxl job admin config admin config null public static xxl job admin config get admin config return admin config override public void after property set throw exception admin config this conf value xxl job login username private string login username value xxl job login password private string login password value xxl job i18n private string i18n value xxl job access token private string access token value spring mail username private string email user name dao service resource private xxl job log dao xxl job log dao resource private xxl job info dao xxl job info dao resource private xxl job registry dao xxl job registry dao resource private xxl job group dao xxl job group dao resource private admin biz admin biz resource private java mail sender mail sender public string get login username return login username public string get login password return login password public string get i18n return i18n public string get access token return access token public string get email user name return email user name public xxl job log dao get xxl job log dao return xxl job log dao public xxl job info dao get xxl job info dao return xxl job info dao public xxl job registry dao get xxl job registry dao return xxl job registry dao public xxl job group dao get xxl job group dao return xxl job group dao public admin biz get admin biz return admin biz public java mail sender get mail sender return mail sender 
xxl job dynamic scheduler config configuration public class xxl job dynamic scheduler config bean public scheduler factory bean get scheduler factory bean datum source datum source scheduler factory bean scheduler factory new scheduler factory bean scheduler factory set datum source datum source scheduler factory set auto startup true scheduler factory set startup delay scheduler factory set overwrite exist job true db job true false scheduler factory set application context scheduler context key application context scheduler factory set config location new class path resource quartz property return scheduler factory bean init method start destroy method destroy public xxl job dynamic scheduler get xxl job dynamic scheduler scheduler factory bean scheduler factory scheduler scheduler scheduler factory get scheduler xxl job dynamic scheduler xxl job dynamic scheduler new xxl job dynamic scheduler xxl job dynamic scheduler set scheduler scheduler return xxl job dynamic scheduler 
xxl job config configuration component scan base package com xxl job executor service jobhandler public class xxl job config private logger logger logger factory get logger xxl job config class value xxl job admin address private string admin address value xxl job executor appname private string app name value xxl job executor ip private string ip value xxl job executor port private int port value xxl job access token private string access token value xxl job executor logpath private string log path value xxl job executor logretentionday private int log retention day bean init method start destroy method destroy public xxl job spring executor xxl job executor logger info xxl job config init xxl job spring executor xxl job spring executor new xxl job spring executor xxl job spring executor set admin address admin address xxl job spring executor set app name app name xxl job spring executor set ip ip xxl job spring executor set port port xxl job spring executor set access token access token xxl job spring executor set log path log path xxl job spring executor set log retention day log retention day return xxl job spring executor 
security secure config configuration public class security secure config extend web security configurer adapter private final string admin context path public security secure config admin server property admin server property this admin context path admin server property get context path override protect void configure http security http throw exception save request aware authentication success handler success handler new save request aware authentication success handler success handler set target url parameter redirect to success handler set default target url admin context path http authorize request ant matcher admin context path asset permit all ant matcher admin context path login permit all any request authenticate and form login login page admin context path login success handler success handler and logout logout url admin context path logout and http basic and header frame option disable and csrf disable 
authorization server config configuration enable authorization server auto configure after authorization server endpoint configurer class public class authorization server config extend authorization server configurer adapter authentication manager password grant type autowired private authentication manager authentication manager resource private user detail service user detail service autowire private token store token store autowire required false private jwt access token converter jwt access token converter autowired require false private token enhancer token enhancer autowire private web response exception translator web response exception translator autowire private redis client detail service client detail service autowire private random value authorization code service authorization code service autowire private token granter token granter token store token granter o auth2 request factory param endpoint override public void configure authorization server endpoint configurer endpoint if jwt access token converter null if token enhancer null token enhancer chain token enhancer chain new token enhancer chain token enhancer chain set token enhancer array as list token enhancer jwt access token converter endpoint token enhancer token enhancer chain else endpoint access token converter jwt access token converter endpoint token store token store authentication manager authentication manager user detail service user detail service authorization code service authorization code service exception translator web response exception translator token granter token granter id o auth2 param client throw exception override public void configure client detail service configurer client throw exception client with client detail client detail service client detail service load all client to cache authorization server client credentials token endpoint filter param security override public void configure authorization server security configurer security security token key access be authenticate check token access permit all oauth token client id client secret allow form authentication for client 
security config configuration import default password config class public class security config extend web security configurer adapter autowire private authentication success handler authentication success handler autowire required false private authentication entry point authentication entry point resource private user detail service user detail service autowire private password encoder password encoder resource private logout handler oauth logout handler autowire private open id authentication security config open id authentication security config autowire private mobile authentication security config mobile authentication security config autowire private authentication manager authentication manager autowire private tenant authentication security config tenant authentication security config autowire private tenant property tenant property spring boot authentication manager return bean override public authentication manager authentication manager bean throw exception return super authentication manager bean bean public tenant username password authentication filter tenant authentication filter authentication manager authentication manager tenant username password authentication filter filter new tenant username password authentication filter filter set authentication manager authentication manager filter set filter process url security constant oauth login pro url filter set authentication success handler authentication success handler filter set authentication failure handler new simple url authentication failure handler security constant login failure page return filter override protect void configure http security http throw exception http authorize request any request basic permit all and logout logout url security constant logout url logout success handler new oauth logout success handler add logout handler oauth logout handler clear authentication true and apply open id authentication security config and apply mobile authentication security config and add filter before new login process set tenant filter username password authentication filter class csrf disable iframe header frame option disable cache control if tenant property get enable http form login login page security constant login page and add filter at tenant authentication filter authentication manager username password authentication filter class apply tenant authentication security config else http form login login page security constant login page login processing url security constant oauth login pro url success handler authentication success handler session if authentication entry point null http exception handle authentication entry point authentication entry point http session management session creation policy session creation policy stateless else session oauth2 http session management session creation policy session creation policy if require autowire public void global user detail authentication manager builder auth throw exception auth user detail service user detail service password encoder password encoder 
security handler config slf4j configuration public class security handler config bean public oauth logout handler oauth logout handler return new oauth logout handler bean public web response exception translator web response exception translator return new default web response exception translator public static final string bad msg override public response entity o auth2 exception translate exception e throw exception o auth2 exception o auth2 exception if e get message null e get message equal bad msg o auth2 exception new invalid grant exception e else if e instanceof internal authentication service exception o auth2 exception new invalid grant exception e get message e else if e instanceof redirect mismatch exception o auth2 exception new invalid grant exception e get message e else if e instanceof invalid scope exception o auth2 exception new invalid grant exception e get message e else o auth2 exception new unsupported response type exception e response entity o auth2 exception response super translate o auth2 exception response entity status o auth2 exception get http error code response get body add additional information resp code o auth2 exception get http error code response get body add additional information resp msg o auth2 exception get message return response bean public authentication success handler login success handler return new save request aware authentication success handler override public void on authentication success http servlet request request http servlet response response authentication authentication throw i o exception servlet exception super on authentication success request response authentication 
token granter config configuration public class token granter config autowire private client detail service client detail service autowire private user detail service user detail service autowire private authentication manager authentication manager autowire private token store token store autowire required false private token enhancer token enhancer autowire private i validate code service validate code service autowire private random value authorization code service authorization code service private boolean reuse refresh token true private authorization server token service token service private token granter token granter bean public token granter token granter if token granter null token granter new token granter private composite token granter delegate override public o auth2 access token grant string grant type token request token request if delegate null delegate new composite token granter get all token granter return delegate grant grant type token request return token granter private list token granter get all token granter authorization server token service token service token service authorization code service authorization code service authorization code service o auth2 request factory request factory request factory list token granter token granter get default token granter token service authorization code service request factory if authentication manager null token granter add new pwd img code granter authentication manager token service client detail service request factory validate code service open id token granter add new open id granter authentication manager token service client detail service request factory token granter add new mobile pwd granter authentication manager token service client detail service request factory return token granter private list token granter get default token granter authorization server token service token service authorization code service authorization code service o auth2 request factory request factory list token granter token granter new array list token granter add new authorization code token granter token service authorization code service client detail service request factory token granter add new refresh token granter token service client detail service request factory token granter add new implicit token granter token service client detail service request factory token granter add new client credentials token granter token service client detail service request factory if authentication manager null token granter add new resource owner password token granter authentication manager token service client detail service request factory return token granter private authorization server token service token service if token service null return token service this token service create default token service return token service private authorization code service authorization code service if authorization code service null authorization code service new in memory authorization code service return authorization code service private o auth2 request factory request factory return new default o auth2 request factory client detail service private default token service create default token service default token service token service new default token service token service set token store token store token service set support refresh token true token service set reuse refresh token reuse refresh token token service set client detail service client detail service token service set token enhancer token enhancer add user detail service token service this user detail service return token service private void add user detail service default token service token service user detail service user detail service if user detail service null pre authenticate authentication provider provider new pre authenticate authentication provider provider set pre authenticate user detail service new user detail by name service wrapper user detail service token service set authentication manager new provider manager collection singleton list provider 
web mvc config configuration public class web mvc config extend default web mvc config 
admin service application enable aspect j auto proxy enable eureka client configuration property source value classpath adminservice property enable auto configuration enable transaction management component scan base package class apollo common config class apollo biz config class admin service application class public class admin service application public static void main string arg spring application run admin service application class arg 
test web security config configuration order public class test web security config extend web security configurer adapter override protect void configure http security http throw exception http http basic http csrf disable http authorize request ant matcher permit all and authorize request ant matcher console permit all http header frame option disable 
admin service test configuration configuration component scan exclude filter filter type filter type assignable type value local admin service application class admin service application class http message converter configuration class enable auto configuration public class admin service test configuration 
apollo biz config enable auto configuration configuration component scan base package class apollo biz config class public class apollo biz config 
web security config conditional on miss profile auth configuration enable web security enable global method security pre post enable true public class web security config extend web security configurer adapter override protect void configure http security http throw exception http http basic http csrf disable http header frame option same origin although the authentication below be useless we may not remove they for backward compatibility because if we remove they and the old client before 0.9 still send the authentication information the server will return which should cause big problem we may remove the follow once we remove spring security from apollo autowire public void configure global authentication manager builder auth throw exception auth in memory authentication with user user password role user and with user apollo password role user admin 
biz test configuration configuration enable auto configuration component scan base package class apollo common config class apollo biz config class public class biz test configuration 
apollo auto configuration configuration conditional on property property source constant apollo bootstrap enable conditional on miss bean property source processor class public class apollo auto configuration bean public config property source processor config property source processor return new config property source processor 
bootstrap config test enable auto configuration configuration static class configuration without conditional on property bean public test bean test bean return new test bean 
bootstrap config test conditional on property test bean conditional on key enable auto configuration configuration static class configuration with conditional on property bean public test bean test bean return new test bean 
java config annotation test configuration enable apollo config static class app config1 bean public test apollo config bean1 bean return new test apollo config bean1 
java config annotation test configuration enable apollo config static class app config2 bean public test apollo config bean2 bean return new test apollo config bean2 
java config annotation test configuration enable apollo config static class app config3 bean public test apollo config change listener bean1 bean return new test apollo config change listener bean1 
java config annotation test configuration enable apollo config static class app config4 bean public test apollo config change listener bean2 bean return new test apollo config change listener bean2 
java config annotation test configuration enable apollo config static class app config5 bean public test apollo config change listener bean3 bean return new test apollo config change listener bean3 
java config annotation test configuration enable apollo config static class app config6 bean public test apollo child config bean bean return new test apollo child config bean 
java config annotation test configuration enable apollo config static class app config7 bean public test apollo child config change listener bean return new test apollo child config change listener 
java config annotation test configuration enable apollo config static class app config8 bean public test apollo config change listener with interested key bean bean return new test apollo config change listener with interested key bean 
java config annotation test configuration enable apollo config application yaml namespace static class app config9 bean public test apollo config change listener with yaml file bean return new test apollo config change listener with yaml file 
java config placeholder auto update test configuration enable apollo config static class app config1 bean test java config bean test java config bean return new test java config bean 
java config placeholder auto update test configuration enable apollo config application fx apollo static class app config2 bean test java config bean test java config bean return new test java config bean 
java config placeholder auto update test configuration enable apollo config static class app config3 this case win t get auto update bean test java config bean2 test java config bean2 value timeout int timeout value batch int batch test java config bean2 bean new test java config bean2 bean set timeout timeout bean set batch batch return bean 
java config placeholder auto update test configuration component scan include filter filter type filter type annotation value component class exclude filter filter type filter type annotation value configuration class enable apollo config static class app config4 
java config placeholder auto update test configuration enable apollo config static class app config5 bean test java config bean4 test java config bean return new test java config bean4 
java config placeholder auto update test configuration enable apollo config static class app config6 bean test java config bean5 test java config bean return new test java config bean5 
java config placeholder auto update test configuration enable apollo config static class app config7 value batch private int batch bean value timeout test java config bean2 test java config bean2 int timeout test java config bean2 bean new test java config bean2 bean set timeout timeout bean set batch batch return bean 
java config placeholder auto update test configuration enable apollo config import resource spring xml config placeholder test1 xml static class app config8 bean test java config bean test java config bean return new test java config bean 
java config placeholder auto update test configuration enable apollo config static class app config9 bean test all kind of datum type bean test all kind of datum type bean return new test all kind of datum type bean 
java config placeholder auto update test configuration enable apollo config static class nest property config1 bean test nest property bean test nest property bean return new test nest property bean 
java config placeholder auto update test configuration enable apollo config static class nest property config2 bean test nest property bean with default value test nest property bean return new test nest property bean with default value 
java config placeholder auto update test configuration enable apollo config static class app config10 bean test apollo json value test apollo json value return new test apollo json value 
java config placeholder auto update test configuration enable apollo config static class app config11 bean test apollo json value with default value test apollo json value return new test apollo json value with default value 
java config placeholder auto update test configuration enable apollo config application ya ml static class app config12 bean test java config bean test java config bean return new test java config bean 
java config placeholder auto update test configuration enable apollo config application yaml import resource spring xml config placeholder test11 xml static class app config13 bean test java config bean test java config bean return new test java config bean 
java config placeholder auto update test configuration enable apollo config application yml fx apollo static class app config14 bean test java config bean test java config bean return new test java config bean 
java config placeholder test configuration enable apollo config static class app config1 bean test java config bean test java config bean return new test java config bean 
java config placeholder test configuration enable apollo config application static class app config2 bean test java config bean test java config bean return new test java config bean 
java config placeholder test configuration enable apollo config application fx apollo static class app config3 bean test java config bean test java config bean return new test java config bean 
java config placeholder test configuration enable apollo config value fx apollo order static class app config4 
java config placeholder test configuration enable apollo config static class app config5 bean test java config bean2 test java config bean2 value timeout int timeout value batch int batch test java config bean2 bean new test java config bean2 bean set timeout timeout bean set batch batch return bean 
java config placeholder test configuration enable apollo config fx apollo application static class app config6 bean test java config bean test java config bean return new test java config bean 
java config placeholder test configuration component scan include filter filter type filter type annotation value component class exclude filter filter type filter type annotation value configuration class enable apollo config static class app config7 
java config placeholder test configuration enable apollo config static class nest property config1 bean test nest property bean test nest property bean return new test nest property bean 
java config placeholder test configuration enable apollo config static class app config8 bean test json property bean test java config bean return new test json property bean 
java config placeholder test configuration enable apollo config application yaml static class app config9 bean test java config bean test java config bean return new test java config bean 
java config placeholder test configuration enable apollo config application ya ml static class app config10 bean test java config bean test java config bean return new test java config bean 
java config placeholder test configuration enable apollo config application yml fx apollo static class app config11 bean test java config bean test java config bean return new test java config bean 
apollo common config enable auto configuration configuration component scan base package class apollo common config class public class apollo common config 
character encode filter configuration configuration public class character encode filter configuration bean public filter registration bean encode filter filter registration bean bean new filter registration bean bean set filter new character encode filter bean add init parameter encode utf fixme http github com netflix eureka issue bean add init parameter force encode true bean set name encode filter bean add url pattern bean set dispatcher type dispatcher type request dispatcher type forward return bean 
http message converter configuration configuration public class http message converter configuration bean public http message converter message converter gson http message converter gson http message converter new gson http message converter gson http message converter set gson new gson builder set date format yyyy mm dd t hh mm ss sssz create final list http message converter converter list new array list new byte array http message converter new string http message converter new all encompass form http message converter gson http message converter return new http message converter override public list http message converter get converter return converter 
web mvc config configuration public class web mvc config implement web mvc configurer web server factory customizer tomcat servlet web server factory override public void add argument resolver list handler method argument resolver argument resolver pageable handler method argument resolver page resolver new pageable handler method argument resolver page resolver set fallback pageable page request of argument resolver add page resolver override public void configure content negotiation content negotiation configurer configurer configurer favor path extension false override public void customize tomcat servlet web server factory factory mime mapping mapping new mime mapping mime mapping default mapping add html text html charset utf factory set mime mapping mapping override public void add resource handler resource handler registry registry day add cache control registry img add cache control registry vendor add cache control registry script add cache control registry style day add cache control registry view add cache control registry i18n private void add cache control resource handler registry registry string folder int cache period registry add resource handler string format s folder add resource location string format classpath static s folder set cache period cache period 
conditional on profile test configuration static class test configuration configuration conditional on profile some profile static class some configuration some configuration enable true configuration conditional on miss profile another profile static class another configuration another configuration enable true configuration conditional on miss profile yet another profile static class yet another configuration yet another configuration enable true configuration conditional on profile some profile another profile conditional on miss profile yet another profile static class combine configuration combine configuration enable true configuration conditional on profile some profile conditional on miss profile yet another profile another profile static class another combine configuration another combine configuration enable true 
conditional on profile test configuration conditional on profile some profile static class some configuration some configuration enable true 
conditional on profile test configuration conditional on miss profile another profile static class another configuration another configuration enable true 
conditional on profile test configuration conditional on miss profile yet another profile static class yet another configuration yet another configuration enable true 
conditional on profile test configuration conditional on profile some profile another profile conditional on miss profile yet another profile static class combine configuration combine configuration enable true 
conditional on profile test configuration conditional on profile some profile conditional on miss profile yet another profile another profile static class another combine configuration another combine configuration enable true 
config server eureka client configure configuration enable eureka client conditional on property name apollo eureka client enable have value true match if missing true public class config server eureka client configure 
config server eureka server configure configuration enable eureka server conditional on property name apollo eureka server enable have value true match if missing true public class config server eureka server configure 
config service application enable aspect j auto proxy enable auto configuration exclude eureka client config bean class configuration enable transaction management property source value classpath configservice property component scan base package class apollo common config class apollo biz config class config service application class apollo meta service config class public class config service application public static void main string arg throw exception spring application run config service application class arg 
config service auto configuration configuration public class config service auto configuration private final biz config biz config public config service auto configuration final biz config biz config this biz config biz config bean public gray release rule holder gray release rule holder return new gray release rule holder bean public config service config service if biz config be config service cache enable return new config service with cache return new default config service bean public static no op password encoder password encoder return no op password encoder no op password encoder get instance bean public filter registration bean client authentication filter access key util access key util filter registration bean filter registration bean new filter registration bean filter registration bean set filter new client authentication filter access key util filter registration bean add url pattern config filter registration bean add url pattern configfile filter registration bean add url pattern notification v2 return filter registration bean configuration static class message scanner configuration private final notification controller notification controller private final config file controller config file controller private final notification controller v2 notification controller v2 private final gray release rule holder gray release rule holder private final release message service with cache release message service with cache private final config service config service public message scanner configuration final notification controller notification controller final config file controller config file controller final notification controller v2 notification controller v2 final gray release rule holder gray release rule holder final release message service with cache release message service with cache final config service config service this notification controller notification controller this config file controller config file controller this notification controller v2 notification controller v2 this gray release rule holder gray release rule holder this release message service with cache release message service with cache this config service config service bean public release message scanner release message scanner release message scanner release message scanner new release message scanner handle release message cache release message scanner add message listener release message service with cache handle gray release rule release message scanner add message listener gray release rule holder handle server cache release message scanner add message listener config service release message scanner add message listener config file controller notify client release message scanner add message listener notification controller v2 release message scanner add message listener notification controller return release message scanner 
config service auto configuration configuration static class message scanner configuration private final notification controller notification controller private final config file controller config file controller private final notification controller v2 notification controller v2 private final gray release rule holder gray release rule holder private final release message service with cache release message service with cache private final config service config service public message scanner configuration final notification controller notification controller final config file controller config file controller final notification controller v2 notification controller v2 final gray release rule holder gray release rule holder final release message service with cache release message service with cache final config service config service this notification controller notification controller this config file controller config file controller this notification controller v2 notification controller v2 this gray release rule holder gray release rule holder this release message service with cache release message service with cache this config service config service bean public release message scanner release message scanner release message scanner release message scanner new release message scanner handle release message cache release message scanner add message listener release message service with cache handle gray release rule release message scanner add message listener gray release rule holder handle server cache release message scanner add message listener config service release message scanner add message listener config file controller notify client release message scanner add message listener notification controller v2 release message scanner add message listener notification controller return release message scanner 
apollo meta service config enable auto configuration configuration component scan base package class apollo meta service config class public class apollo meta service config bean public http firewall allow url encode slash http firewall return new default http firewall 
test web security config configuration order public class test web security config extend web security configurer adapter override protect void configure http security http throw exception http http basic http csrf disable http authorize request ant matcher permit all and authorize request ant matcher console permit all http header frame option disable 
abstract base integration test configuration import config service test configuration class protect static class test configuration bean public biz config biz config final biz d b property source biz d b property source return new test biz config biz d b property source 
config service test configuration configuration component scan exclude filter filter type filter type assignable type value local config service application class config service application class web security config class enable auto configuration public class config service test configuration 
another app config configuration enable apollo config value t e s t1 apollo application yaml order public class another app config 
app config configuration enable apollo config value application order public class app config 
apollo mock server spring integration test enable apollo config configuration static class test configuration bean public test bean test bean return new test bean bean public test interested key prefix bean test interested key prefix bean return new test interested key prefix bean 
portal open api config enable auto configuration configuration component scan base package class portal open api config class public class portal open api config 
portal application enable aspect j auto proxy configuration enable auto configuration enable transaction management component scan base package class apollo common config class portal application class portal open api config class public class portal application public static void main string arg throw exception spring application run portal application class arg 
auth configuration configuration public class auth configuration spring profile active ctrip configuration profile ctrip static class ctrip auth auto configuration private final portal config portal config public ctrip auth auto configuration final portal config portal config this portal config portal config bean public servlet listener registration bean redis app set listner servlet listener registration bean redis app set listener new servlet listener registration bean redis app set listener set listener listener org jasig cas client credi c redis app set listner return redis app set listener bean public servlet listener registration bean single sign out http session listener servlet listener registration bean single sign out http session listener new servlet listener registration bean single sign out http session listener set listener listener org jasig cas client session single sign out http session listener return single sign out http session listener bean public filter registration bean ca filter filter registration bean single sign out filter new filter registration bean single sign out filter set filter filter org jasig cas client session single sign out filter single sign out filter add url pattern single sign out filter set order return single sign out filter bean public filter registration bean authentication filter filter registration bean ca filter new filter registration bean map string string filter init param map new hash map filter init param put redis cluster name ca client principal filter init param put server name portal config portal server name filter init param put cas server login url portal config cas server login url we don t want to use session to store login information since we will be deploy to a cluster not a single instance filter init param put use session false filter init param put openapus exclude ca filter set init parameter filter init param ca filter set filter filter com ctrip framework apollo sso filter apollo authentication filter ca filter add url pattern ca filter set order return ca filter bean public filter registration bean cas validation filter filter registration bean cas validation filter new filter registration bean map string string filter init param map new hash map filter init param put cas server url prefix portal config cas server url prefix filter init param put server name portal config portal server name filter init param put encode utf we don t want to use session to store login information since we will be deploy to a cluster not a single instance filter init param put use session false filter init param put use redis true filter init param put redis cluster name ca client principal cas validation filter set filter filter org jasig cas client validation cas20 proxy receive ticket validation filter cas validation filter set init parameter filter init param cas validation filter add url pattern ca validation filter set order return ca validation filter bean public filter registration bean assertion holder filter registration bean assertion holder filter new filter registration bean map string string filter init param map new hash map filter init param put openapus exclude assertion holder filter set init parameter filter init param assertion holder filter set filter filter com ctrip framework apollo sso filter apollo assertion thread local filter assertion holder filter add url pattern assertion holder filter set order return assertion holder filter bean public ctrip user info holder ctrip user info holder return new ctrip user info holder bean public ctrip logout handler logout handler return new ctrip logout handler private filter filter string class name class clazz null try clazz class for name class name object obj clazz new instance return filter obj catch exception e throw new runtime exception instance filter fail e private event listener listener string class name class clazz null try clazz class for name class name object obj clazz new instance return event listener obj catch exception e throw new runtime exception instance listener fail e bean public user service ctrip user service portal config portal config return new ctrip user service portal config bean public sso heartbeat handler ctrip sso heartbeat handler return new ctrip sso heartbeat handler spring profile active auth configuration profile auth static class spring security auth auto configuration bean conditional on miss bean sso heartbeat handler class public sso heartbeat handler default sso heartbeat handler return new default sso heartbeat handler bean conditional on miss bean user info holder class public user info holder spring security user info holder return new spring security user info holder bean conditional on miss bean logout handler class public logout handler logout handler return new default logout handler bean public jdbc user detail manager jdbc user detail manager authentication manager builder auth datum source datasource throw exception jdbc user detail manager jdbc user detail manager auth jdbc authentication password encoder new b crypt password encoder datum source datasource user by username query select username password enable from user where username authority by username query select username authority from authority where username get user detail service jdbc user detail manager set user exist sql select username from user where username jdbc user detail manager set create user sql insert into user username password enable value jdbc user detail manager set update user sql update user set password enable where id select u id from select id from user where username as u jdbc user detail manager set delete user sql delete from user where id select u id from select id from user where username as u jdbc user detail manager set create authority sql insert into authority username authority value jdbc user detail manager set delete user authority sql delete from authority where id in select a id from select id from authority where username as a jdbc user detail manager set change password sql update user set password where id select u id from select id from user where username as u return jdbc user detail manager bean conditional on miss bean user service class public user service spring security user service return new spring security user service order profile auth configuration enable web security enable global method security pre post enable true static class spring security configurer extend web security configurer adapter public static final string user role user override protect void configure http security http throw exception http csrf disable http header frame option same origin http authorize request ant matcher prometheus metric openapi vendor style script view img i18n prefix path permit all ant matcher have any role user role http form login login page signin default success url true permit all failure url signin error and http basic http logout logout url user logout invalidate http session true clear authentication true logout success url signin logout http exception handle authentication entry point new login url authentication entry point signin spring profile active ldap configuration profile ldap enable configuration property ldap property class ldap extend property class static class spring security l d a p auth auto configuration private final ldap property property private final environment environment public spring security l d a p auth auto configuration final ldap property property final environment environment this property property this environment environment bean conditional on miss bean sso heartbeat handler class public sso heartbeat handler default sso heartbeat handler return new default sso heartbeat handler bean conditional on miss bean user info holder class public user info holder spring security user info holder return new spring security user info holder bean conditional on miss bean logout handler class public logout handler logout handler return new default logout handler bean conditional on miss bean user service class public user service spring security user service return new ldap user service bean conditional on miss bean public context source ldap context source ldap context source source new ldap context source source set user dn this property get username source set password this property get password source set anonymous read only this property get anonymous read only source set base this property get base source set url this property determine url this environment source set base environment property collection unmodifiable map this property get base environment return source bean conditional on miss bean ldap operation class public ldap template ldap template context source context source ldap template ldap template new ldap template context source ldap template set ignore partial result exception true return ldap template order profile ldap configuration enable web security enable global method security pre post enable true static class spring security l d a p configurer extend web security configurer adapter private final ldap property ldap property private final ldap context source ldap context source private final ldap extend property ldap extend property public spring security l d a p configurer final ldap property ldap property final ldap context source ldap context source final ldap extend property ldap extend property this ldap property ldap property this ldap context source ldap context source this ldap extend property ldap extend property bean public filter base ldap user search user search if ldap extend property get group null string util be blank ldap extend property get group get group search filter base ldap user search filter base ldap user search new filter base ldap user search ldap property get search filter ldap context source filter base ldap user search set search subtree true return filter base ldap user search filter ldap by group user search filter ldap by group user search new filter ldap by group user search ldap property get base ldap property get search filter ldap extend property get group get group base ldap context source ldap extend property get group get group search ldap extend property get map get rdn key ldap extend property get group get group membership ldap extend property get map get login id filter ldap by group user search set search subtree true return filter ldap by group user search bean public ldap authentication provider ldap auth provider bind authenticator bind authenticator new bind authenticator ldap context source bind authenticator set user search user search default ldap authority populator default auth auto configuration new default ldap authority populator ldap context source null default auth auto configuration set ignore partial result exception true default auth auto configuration set search subtree true rewrite the logic of ldap authentication provider with apollo ldap authentication provider use user id in ldap system instead of user id input by user return new apollo ldap authentication provider bind authenticator default auth auto configuration ldap extend property override protect void configure http security http throw exception http csrf disable http header frame option same origin http authorize request ant matcher prometheus metric openapi vendor style script view img i18n prefix path permit all ant matcher authenticate http form login login page signin default success url true permit all failure url signin error and http basic http logout logout url user logout invalidate http session true clear authentication true logout success url signin logout http exception handle authentication entry point new login url authentication entry point signin override protect void configure authentication manager builder auth throw exception auth authentication provider ldap auth provider default profile configuration conditional on miss profile ctrip auth ldap static class default auth auto configuration bean conditional on miss bean sso heartbeat handler class public sso heartbeat handler default sso heartbeat handler return new default sso heartbeat handler bean conditional on miss bean user info holder class public default user info holder default user info holder return new default user info holder bean conditional on miss bean logout handler class public default logout handler logout handler return new default logout handler bean conditional on miss bean user service class public user service default user service return new default user service conditional on miss profile auth ldap configuration enable web security enable global method security pre post enable true static class default web security config extend web security configurer adapter override protect void configure http security http throw exception http csrf disable http header frame option same origin 
auth configuration configuration profile ctrip static class ctrip auth auto configuration private final portal config portal config public ctrip auth auto configuration final portal config portal config this portal config portal config bean public servlet listener registration bean redis app set listner servlet listener registration bean redis app set listener new servlet listener registration bean redis app set listener set listener listener org jasig cas client credi c redis app set listner return redis app set listener bean public servlet listener registration bean single sign out http session listener servlet listener registration bean single sign out http session listener new servlet listener registration bean single sign out http session listener set listener listener org jasig cas client session single sign out http session listener return single sign out http session listener bean public filter registration bean ca filter filter registration bean single sign out filter new filter registration bean single sign out filter set filter filter org jasig cas client session single sign out filter single sign out filter add url pattern single sign out filter set order return single sign out filter bean public filter registration bean authentication filter filter registration bean ca filter new filter registration bean map string string filter init param map new hash map filter init param put redis cluster name ca client principal filter init param put server name portal config portal server name filter init param put cas server login url portal config cas server login url we don t want to use session to store login information since we will be deploy to a cluster not a single instance filter init param put use session false filter init param put openapus exclude ca filter set init parameter filter init param ca filter set filter filter com ctrip framework apollo sso filter apollo authentication filter ca filter add url pattern ca filter set order return ca filter bean public filter registration bean cas validation filter filter registration bean cas validation filter new filter registration bean map string string filter init param map new hash map filter init param put cas server url prefix portal config cas server url prefix filter init param put server name portal config portal server name filter init param put encode utf we don t want to use session to store login information since we will be deploy to a cluster not a single instance filter init param put use session false filter init param put use redis true filter init param put redis cluster name ca client principal cas validation filter set filter filter org jasig cas client validation cas20 proxy receive ticket validation filter cas validation filter set init parameter filter init param cas validation filter add url pattern ca validation filter set order return ca validation filter bean public filter registration bean assertion holder filter registration bean assertion holder filter new filter registration bean map string string filter init param map new hash map filter init param put openapus exclude assertion holder filter set init parameter filter init param assertion holder filter set filter filter com ctrip framework apollo sso filter apollo assertion thread local filter assertion holder filter add url pattern assertion holder filter set order return assertion holder filter bean public ctrip user info holder ctrip user info holder return new ctrip user info holder bean public ctrip logout handler logout handler return new ctrip logout handler private filter filter string class name class clazz null try clazz class for name class name object obj clazz new instance return filter obj catch exception e throw new runtime exception instance filter fail e private event listener listener string class name class clazz null try clazz class for name class name object obj clazz new instance return event listener obj catch exception e throw new runtime exception instance listener fail e bean public user service ctrip user service portal config portal config return new ctrip user service portal config bean public sso heartbeat handler ctrip sso heartbeat handler return new ctrip sso heartbeat handler 
auth configuration configuration profile auth static class spring security auth auto configuration bean conditional on miss bean sso heartbeat handler class public sso heartbeat handler default sso heartbeat handler return new default sso heartbeat handler bean conditional on miss bean user info holder class public user info holder spring security user info holder return new spring security user info holder bean conditional on miss bean logout handler class public logout handler logout handler return new default logout handler bean public jdbc user detail manager jdbc user detail manager authentication manager builder auth datum source datasource throw exception jdbc user detail manager jdbc user detail manager auth jdbc authentication password encoder new b crypt password encoder datum source datasource user by username query select username password enable from user where username authority by username query select username authority from authority where username get user detail service jdbc user detail manager set user exist sql select username from user where username jdbc user detail manager set create user sql insert into user username password enable value jdbc user detail manager set update user sql update user set password enable where id select u id from select id from user where username as u jdbc user detail manager set delete user sql delete from user where id select u id from select id from user where username as u jdbc user detail manager set create authority sql insert into authority username authority value jdbc user detail manager set delete user authority sql delete from authority where id in select a id from select id from authority where username as a jdbc user detail manager set change password sql update user set password where id select u id from select id from user where username as u return jdbc user detail manager bean conditional on miss bean user service class public user service spring security user service return new spring security user service 
auth configuration order profile auth configuration enable web security enable global method security pre post enable true static class spring security configurer extend web security configurer adapter public static final string user role user override protect void configure http security http throw exception http csrf disable http header frame option same origin http authorize request ant matcher prometheus metric openapi vendor style script view img i18n prefix path permit all ant matcher have any role user role http form login login page signin default success url true permit all failure url signin error and http basic http logout logout url user logout invalidate http session true clear authentication true logout success url signin logout http exception handle authentication entry point new login url authentication entry point signin 
auth configuration configuration profile ldap enable configuration property ldap property class ldap extend property class static class spring security l d a p auth auto configuration private final ldap property property private final environment environment public spring security l d a p auth auto configuration final ldap property property final environment environment this property property this environment environment bean conditional on miss bean sso heartbeat handler class public sso heartbeat handler default sso heartbeat handler return new default sso heartbeat handler bean conditional on miss bean user info holder class public user info holder spring security user info holder return new spring security user info holder bean conditional on miss bean logout handler class public logout handler logout handler return new default logout handler bean conditional on miss bean user service class public user service spring security user service return new ldap user service bean conditional on miss bean public context source ldap context source ldap context source source new ldap context source source set user dn this property get username source set password this property get password source set anonymous read only this property get anonymous read only source set base this property get base source set url this property determine url this environment source set base environment property collection unmodifiable map this property get base environment return source bean conditional on miss bean ldap operation class public ldap template ldap template context source context source ldap template ldap template new ldap template context source ldap template set ignore partial result exception true return ldap template 
auth configuration order profile ldap configuration enable web security enable global method security pre post enable true static class spring security l d a p configurer extend web security configurer adapter private final ldap property ldap property private final ldap context source ldap context source private final ldap extend property ldap extend property public spring security l d a p configurer final ldap property ldap property final ldap context source ldap context source final ldap extend property ldap extend property this ldap property ldap property this ldap context source ldap context source this ldap extend property ldap extend property bean public filter base ldap user search user search if ldap extend property get group null string util be blank ldap extend property get group get group search filter base ldap user search filter base ldap user search new filter base ldap user search ldap property get search filter ldap context source filter base ldap user search set search subtree true return filter base ldap user search filter ldap by group user search filter ldap by group user search new filter ldap by group user search ldap property get base ldap property get search filter ldap extend property get group get group base ldap context source ldap extend property get group get group search ldap extend property get map get rdn key ldap extend property get group get group membership ldap extend property get map get login id filter ldap by group user search set search subtree true return filter ldap by group user search bean public ldap authentication provider ldap auth provider bind authenticator bind authenticator new bind authenticator ldap context source bind authenticator set user search user search default ldap authority populator default auth auto configuration new default ldap authority populator ldap context source null default auth auto configuration set ignore partial result exception true default auth auto configuration set search subtree true rewrite the logic of ldap authentication provider with apollo ldap authentication provider use user id in ldap system instead of user id input by user return new apollo ldap authentication provider bind authenticator default auth auto configuration ldap extend property override protect void configure http security http throw exception http csrf disable http header frame option same origin http authorize request ant matcher prometheus metric openapi vendor style script view img i18n prefix path permit all ant matcher authenticate http form login login page signin default success url true permit all failure url signin error and http basic http logout logout url user logout invalidate http session true clear authentication true logout success url signin logout http exception handle authentication entry point new login url authentication entry point signin override protect void configure authentication manager builder auth throw exception auth authentication provider ldap auth provider 
auth configuration configuration conditional on miss profile ctrip auth ldap static class default auth auto configuration bean conditional on miss bean sso heartbeat handler class public sso heartbeat handler default sso heartbeat handler return new default sso heartbeat handler bean conditional on miss bean user info holder class public default user info holder default user info holder return new default user info holder bean conditional on miss bean logout handler class public default logout handler logout handler return new default logout handler bean conditional on miss bean user service class public user service default user service return new default user service 
auth configuration conditional on miss profile auth ldap configuration enable web security enable global method security pre post enable true static class default web security config extend web security configurer adapter override protect void configure http security http throw exception http csrf disable http header frame option same origin 
auth filter configuration configuration public class auth filter configuration bean public filter registration bean open api authentication filter consumer auth util consumer auth util consumer audit util consumer audit util filter registration bean open api filter new filter registration bean open api filter set filter new consumer authentication filter consumer auth util consumer audit util open api filter add url pattern openapi return open api filter 
email configuration configuration public class email configuration spring profile active ctrip configuration profile ctrip public static class ctrip email configuration bean public email service ctrip email service return new ctrip email service bean public ctrip email request builder email request builder return new ctrip email request builder spring profile active ctrip configuration conditional on miss profile ctrip public static class default email configuration bean conditional on miss bean email service class public email service default email service return new default email service 
email configuration configuration profile ctrip public static class ctrip email configuration bean public email service ctrip email service return new ctrip email service bean public ctrip email request builder email request builder return new ctrip email request builder 
email configuration configuration conditional on miss profile ctrip public static class default email configuration bean conditional on miss bean email service class public email service default email service return new default email service 
m q configuration configuration public class m q configuration configuration profile ctrip public static class ctrip m q configuration bean public ctrip m q service mq service return new ctrip m q service spring profile active ctrip configuration conditional on miss profile ctrip public static class default m q configuration bean public default m q service mq service return new default m q service 
m q configuration configuration profile ctrip public static class ctrip m q configuration bean public ctrip m q service mq service return new ctrip m q service 
m q configuration configuration conditional on miss profile ctrip public static class default m q configuration bean public default m q service mq service return new default m q service 
role configuration configuration public class role configuration bean public role initialization service role initialization service return new default role initialization service bean public role permission service role permission service return new default role permission service 
web context configuration configuration profile ctrip public class web context configuration private final portal config portal config private final user info holder user info holder public web context configuration final portal config portal config final user info holder user info holder this portal config portal config this user info holder user info holder bean public servlet context initializer servlet context initializer return servlet context string log server i p portal config clog url string log server port portal config clog port string credis service url portal config credis service url servlet context set init parameter log server i p string be null or empty log server i p log server i p servlet context set init parameter log server port string be null or empty log server port log server port servlet context set init parameter credis service url string be null or empty credis service url credis service url bean public filter registration bean user access filter filter registration bean filter new filter registration bean filter set filter new user access filter user info holder filter add url pattern return filter 
naco config configuration configuration public class naco config configuration bean public filter registration bean naco web filter registration filter registration bean naco web filter registration new filter registration bean registration set filter naco web filter registration add url pattern v1 c registration set name naco web filter registration set order return registration bean public naco web filter naco web filter return new naco web filter conditional condition distribute embed storage class bean public filter registration bean transfer to leader registration filter registration bean curcuit filter registration new filter registration bean registration set filter transfer to leader registration add url pattern v1 c registration set name curcuit filter registration set order return registration conditional condition distribute embed storage class bean public curcuit filter transfer to leader return new curcuit filter 
auth config component configuration public class auth config just for test private static boolean caching enable null autowired private reloadable config reloadable config secret key value naco core auth default token secret key private string secret key token validity time seconds value naco core auth default token expire seconds private long token validity in seconds which auth system be in use value naco core auth system type private string naco auth system type public string get secret key return secret key public long get token validity in seconds return token validity in seconds public string get naco auth system type return naco auth system type auth function be open return auth function be open public boolean be auth enable runtime d parameter have higher priority string enable system get property naco core auth enable if string util be not blank enable return boolean util to boolean enable return boolean util to boolean reloadable config get property get property naco core auth enable false whether permission information can be cache return bool public boolean be cache enable if object non null auth configs caching enable return cache enable return boolean util to boolean reloadable config get property get property naco core auth caching enable true just for test public static void set caching enable boolean caching enable auth config cache enable cache enable bean public filter registration bean auth filter registration filter registration bean auth filter registration new filter registration bean registration set filter auth filter registration add url pattern registration set name auth filter registration set order return registration bean public auth filter auth filter return new auth filter 
consistency configuration suppress warning all configuration public class consistency configuration bean value strong agreement protocol public c p protocol strong agreement protocol server member manager member manager throw exception final c p protocol protocol get protocol c p protocol class new j raft protocol member manager return protocol private t t get protocol class t cl callable t builder throw exception service loader t protocol service loader load cl select only the first implementation iterator t iterator protocol iterator if iterator have next return iterator next else return builder call 
name config configuration public class name config bean public filter registration bean distro filter registration filter registration bean distro filter registration new filter registration bean registration set filter distro filter registration add url pattern v1 n registration set name distro filter registration set order return registration bean public filter registration bean traffic revise filter registration filter registration bean traffic revise filter registration new filter registration bean registration set filter traffic revise filter registration add url pattern v1 n registration set name traffic revise filter registration set order return registration bean public distro filter distro filter return new distro filter bean public traffic revise filter traffic revise filter return new traffic revise filter 
web flux test config configuration public class web flux test config private final list view resolver view resolver private final server codec configurer server codec configurer public web flux test config object provider list view resolver view resolver provider server codec configurer server codec configurer this view resolver view resolver provider get if available collection empty list this server codec configurer server codec configurer bean order public sentinel block exception handler sentinel block exception handler register the block exception handler for spring web flux return new sentinel block exception handler view resolver server codec configurer bean order public sentinel web flux filter sentinel web flux filter register the sentinel web flux filter return new sentinel web flux filter 
interceptor config configuration public class interceptor config implement web mvc configurer override public void add interceptor interceptor registry registry add sentinel interceptor add spring mvc interceptor registry if you want to sentinel the total flow you can add total interceptor add spring mvc total interceptor registry private void add spring mvc interceptor interceptor registry registry config sentinel web mvc config config new sentinel web mvc config config set block exception handler new block exception handler override public void handle http servlet request request http servlet response response block exception e throw exception string resource name e get rule get resource depend on you situation you can choose to process or throw if hello equal resource name do something write string or json string response get writer write block by sentinel else handle in global exception handle throw e custom configuration if necessary config set http method specify false config set web context unify true config set origin parser new request origin parser override public string parse origin http servlet request request return request get header s user add sentinel interceptor registry add interceptor new sentinel web interceptor config add path pattern private void add spring mvc total interceptor interceptor registry registry configure sentinel web mvc total config config new sentinel web mvc total config custom configuration if necessary config set request attribute name my sentinel spring mvc total entity container config set total resource name my spring mvc total url request add sentinel interceptor registry add interceptor new sentinel web total interceptor config add path pattern 
filter config configuration public class filter config bean public filter registration bean sentinel filter registration filter registration bean registration new filter registration bean registration set filter new common filter registration add url pattern registration set name sentinel filter registration set order return registration 
filter context config configuration public class filter context config bean public filter registration bean sentinel filter registration filter registration bean registration new filter registration bean registration set filter new common filter registration add url pattern registration add init parameter common filter web context unify false registration set name sentinel filter registration set order return registration 
filter method config configuration public class filter method config bean public filter registration bean sentinel filter registration filter registration bean registration new filter registration bean registration set filter new common filter registration add url pattern registration add init parameter common filter http method specify true registration set name sentinel filter registration set order return registration 
web config configuration public class web config implement web mvc configurer private final logger logger logger factory get logger web config class autowire private login authentication filter login authentication filter autowire private authorization interceptor authorization interceptor override public void add interceptor interceptor registry registry registry add interceptor authorization interceptor add path pattern override public void add resource handler resource handler registry registry registry add resource handler add resource location classpath resource override public void add view controller view controller registry registry registry add view controller set view name forward index htm add link common filter to the server this be the simplest way to use sentinel for web application bean public filter registration bean sentinel filter registration filter registration bean filter registration new filter registration bean registration set filter new common filter registration add url pattern registration set name sentinel filter registration set order if this be enable the entrance of all web url resource will be unify as a single context name in most scenario that be enough and it could reduce the memory footprint registration add init parameter common filter web context unify true logger info sentinel servlet common filter register return registration post construct public void do init set string suffix set new hash set array as list j css html ico txt woff woff2 example register a url cleaner to exclude u be l of common static resource web callback manager set url cleaner url if string util be empty url return url if suffix set stream any match url end with return null return url bean public filter registration bean authentication filter registration filter registration bean filter registration new filter registration bean registration set filter login authentication filter registration add url pattern registration set name authentication filter registration set order return registration 
apollo config configuration public class apollo config bean public converter list flow rule entity string flow rule entity encoder return json to j s o n string bean public converter string list flow rule entity flow rule entity decoder return s json parse array s flow rule entity class bean public apollo open api client apollo open api client apollo open api client client apollo open api client new builder with portal url http localhost with token token build return client 
naco config configuration public class naco config bean public converter list flow rule entity string flow rule entity encoder return json to j s o n string bean public converter string list flow rule entity flow rule entity decoder return s json parse array s flow rule entity class bean public config service naco config service throw exception return config factory create config service localhost 
zookeeper config configuration public class zookeeper config bean public converter list flow rule entity string flow rule entity encoder return json to j s o n string bean public converter string list flow rule entity flow rule entity decoder return s json parse array s flow rule entity class bean public curator framework zk client curator framework zk client curator framework factory new client 127.0 0.1 new exponential backoff retry zookeeper config util sleep time zookeeper config util retry time zk client start return zk client 
aop configuration configuration public class aop configuration bean public sentinel resource aspect sentinel resource aspect return new sentinel resource aspect 
consumer configuration configuration dubbo component scan public class consumer configuration bean public application config application config application config application config new application config application config set name demo consumer return application config bean public registry config registry config registry config registry config new registry config registry config set address multicast 224.5 6.7 return registry config bean public consumer config consumer config consumer config consumer config new consumer config uncomment below line if you don t want to enable sentinel for dubbo service consumer consumer config set filter sentinel dubbo consumer filter return consumer config bean public foo service consumer annotation demo service consumer return new foo service consumer 
provider configuration configuration dubbo component scan public class provider configuration bean public application config application config application config application config new application config application config set name demo provider return application config bean public registry config registry config registry config registry config new registry config registry config set address multicast 224.5 6.7 return registry config bean public protocol config protocol config protocol config protocol config new protocol config protocol config set name dubbo protocol config set port return protocol config 
aop config configuration public class aop config bean public sentinel resource aspect sentinel resource aspect return new sentinel resource aspect 
consumer configuration configuration dubbo component scan public class consumer configuration bean public application config application config application config application config new application config application config set name demo consumer return application config bean public registry config registry config registry config registry config new registry config registry config set address multicast 224.5 6.7 return registry config bean public consumer config consumer config consumer config consumer config new consumer config uncomment below line if you don t want to enable sentinel for dubbo service consumer consumer config set filter sentinel dubbo consumer filter return consumer config bean public foo service consumer annotation demo service consumer return new foo service consumer 
provider configuration configuration dubbo component scan com alibaba csp sentinel demo dubbo demo1 public class provider configuration bean public application config application config application config application config new application config application config set name demo provider return application config bean public registry config registry config registry config registry config new registry config registry config set address multicast 224.5 6.7 return registry config bean public protocol config protocol config protocol config protocol config new protocol config protocol config set name dubbo protocol config set port return protocol config 
provider configuration configuration dubbo component scan com alibaba csp sentinel demo dubbo demo2 public class provider configuration bean public application config application config application config application config new application config application config set name demo provider return application config bean public registry config registry config registry config registry config new registry config registry config set address multicast 224.5 6.7 return registry config bean public protocol config protocol config protocol config protocol config new protocol config protocol config set name dubbo protocol config set port return protocol config 
sentinel jax rs config configuration proxy bean method false public class sentinel jax rs config bean public sentinel jax rs provider filter sentinel jax rs provider filter return new sentinel jax rs provider filter 
gateway configuration configuration public class gateway configuration private final list view resolver view resolver private final server codec configurer server codec configurer public gateway configuration object provider list view resolver view resolver provider server codec configurer server codec configurer this view resolver view resolver provider get if available collection empty list this server codec configurer server codec configurer bean order order highest precedence public sentinel gateway block exception handler sentinel gateway block exception handler register the block exception handler for spring cloud gateway return new sentinel gateway block exception handler view resolver server codec configurer bean order public global filter sentinel gateway filter return new sentinel gateway filter post construct public void do init init customize apis init gateway rule private void init customize api set api definition definition new hash set api definition api1 new api definition some customize api set predicate item new hash set api predicate item add new api path predicate item set pattern aha add new api path predicate item set pattern product set match strategy sentinel gateway constant url match strategy prefix api definition api2 new api definition another customize api set predicate item new hash set api predicate item add new api path predicate item set pattern set match strategy sentinel gateway constant url match strategy prefix definition add api1 definition add api2 gateway api definition manager load api definition definition private void init gateway rule set gateway flow rule rule new hash set rule add new gateway flow rule aliyun route set count set interval sec rule add new gateway flow rule aliyun route set count set interval sec set burst set param item new gateway param flow item set parse strategy sentinel gateway constant param parse strategy client ip rule add new gateway flow rule httpbin route set count set interval sec set control behavior rule constant control behavior rate limiter set max queue timeout ms set param item new gateway param flow item set parse strategy sentinel gateway constant param parse strategy header set field name x sentinel flag rule add new gateway flow rule httpbin route set count set interval sec set param item new gateway param flow item set parse strategy sentinel gateway constant param parse strategy url param set field name pa rule add new gateway flow rule httpbin route set count set interval sec set param item new gateway param flow item set parse strategy sentinel gateway constant param parse strategy url param set field name type set pattern warn set match strategy sentinel gateway constant param match strategy contain rule add new gateway flow rule some customize api set resource mode sentinel gateway constant resource mode custom api name set count set interval sec set param item new gateway param flow item set parse strategy sentinel gateway constant param parse strategy url param set field name pn gateway rule manager load rule rule 
redi config configuration public class redis config bean public reactive redis template string string string reactive redis template reactive redis connection factory connection factory redis serialization context string string serialization context redis serialization context string string new serialization context new string redis serializer hash key new string redis serializer hash value new string redis serializer build return new reactive redis template connection factory serialization context 
web flux config configuration public class web flux config private final list view resolver view resolver private final server codec configurer server codec configurer public web flux config object provider list view resolver view resolver provider server codec configurer server codec configurer this view resolver view resolver provider get if available collection empty list this server codec configurer server codec configurer bean order public sentinel block exception handler sentinel block exception handler register the block exception handler for spring web flux return new sentinel block exception handler view resolver server codec configurer bean order public sentinel web flux filter sentinel web flux filter register the sentinel web flux filter return new sentinel web flux filter 
interceptor config configuration public class interceptor config implement web mvc configurer override public void add interceptor interceptor registry registry add sentinel interceptor add spring mvc interceptor registry private void add spring mvc interceptor interceptor registry registry sentinel web mvc config config new sentinel web mvc config depend on you situation you can choose to process the block exception via the block exception handler or throw it directly then handle it in spring web global exception handler config set block exception handler request response e throw e use the default handler config set block exception handler new default block exception handler custom configuration if necessary config set http method specify true by default web context be true means that unify web context i e use the default context name in most scenario that be enough and it could reduce the memory footprint if set it to false entrance context will be separate by different u be l which be useful to support chain relation flow strategy we can change it and view different result in resource chain menu of dashboard config set web context unify true config set origin parser request request get header s user add sentinel interceptor registry add interceptor new sentinel web interceptor config add path pattern private void add spring mvc total interceptor interceptor registry registry config sentinel web mvc total config config new sentinel web mvc total config custom configuration if necessary config set request attribute name my sentinel spring mvc total entity container config set total resource name my spring mvc total url request add sentinel interceptor registry add interceptor new sentinel web total interceptor config add path pattern 
gateway rule config configuration public class gateway rule config post construct public void do init prepare some gateway rule and api definition only for demo it be recommend to leverage dynamic datum source or the sentinel dashboard to push the rule init customize apis init gateway rule private void init customize api set api definition definition new hash set api definition api1 new api definition some customize api set predicate item new hash set api predicate item add new api path predicate item set pattern aha add new api path predicate item set pattern aliyun product set match strategy sentinel gateway constant url match strategy prefix api definition api2 new api definition another customize api set predicate item new hash set api predicate item add new api path predicate item set pattern set match strategy sentinel gateway constant url match strategy prefix definition add api1 definition add api2 gateway api definition manager load api definition definition private void init gateway rule set gateway flow rule rule new hash set rule add new gateway flow rule aliyun product route set count set interval sec rule add new gateway flow rule aliyun product route set count set interval sec set burst set param item new gateway param flow item set parse strategy sentinel gateway constant param parse strategy client ip rule add new gateway flow rule another route httpbin set count set interval sec set control behavior rule constant control behavior rate limiter set max queue timeout ms set param item new gateway param flow item set parse strategy sentinel gateway constant param parse strategy header set field name x sentinel flag rule add new gateway flow rule another route httpbin set count set interval sec set param item new gateway param flow item set parse strategy sentinel gateway constant param parse strategy url param set field name pa rule add new gateway flow rule some customize api set resource mode sentinel gateway constant resource mode custom api name set count set interval sec set param item new gateway param flow item set parse strategy sentinel gateway constant param parse strategy url param set field name pn gateway rule manager load rule rule 
zuul config configuration public class zuul config bean public zuul filter sentinel zuul pre filter return new sentinel zuul pre filter bean public zuul filter sentinel zuul post filter return new sentinel zuul post filter bean public zuul filter sentinel zuul error filter return new sentinel zuul error filter 
aop test config configuration enable aspect j auto proxy proxy target class true component scan com alibaba csp sentinel annotation aspectj integration public class aop test config bean public sentinel resource aspect sentinel resource aspect return new sentinel resource aspect 
datum source bootstrap configuration configuration public class datum source bootstrap configuration autowire private configurable environment environment bean public sentinel rule locator sentinel property source locator config client property property sentinel rule locator locator new sentinel rule locator property environment return locator 
